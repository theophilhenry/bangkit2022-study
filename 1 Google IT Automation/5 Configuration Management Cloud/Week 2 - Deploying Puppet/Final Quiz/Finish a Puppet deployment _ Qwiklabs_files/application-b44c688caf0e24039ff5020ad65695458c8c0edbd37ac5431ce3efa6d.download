function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function status(e){return 200<=e.status&&e.status<300?Promise.resolve(e):Promise.reject(e)}function json(e){return e.json()}function text(e){return e.text()}function expireV2Token(){ql.labData.setRecaptchaV2Token(undefined)}function recaptchaComplete(e){ql.labData.setRecaptchaV2Token(e),ql.labRun.startLab({accessSuccess:!1})}function requestStartLab(){ql.labData.isRecaptchaEnabled()&&!ql.labData.getRecaptchaV2Token()?(ql.track("clicked_start_lab_button",ql.labData.getAnalyticsPayload()),document.getElementById("g-recaptcha-response-data-start-lab")?($.ajaxSetup({timeout:3e3}),executeRecaptchaForStartLabAsync().then(function(e){$.post("/focuses/verify_v3_recaptcha",{recaptchaV3Token:e,id:ql.labData.getFocusId(),parent:ql.labData.getParent()}).done(function(e){e.is_verified?ql.labRun.startLab({accessSuccess:!1}):ql.labControlPanel.showV2Recaptcha()}).error(function(){return ql.labControlPanel.showV2Recaptcha()})})):ql.labControlPanel.showV2Recaptcha()):ql.labRun.startLab({accessSuccess:!1})}var _slicedToArray=function(){function n(e,t){var n=[],o=!0,i=!1,a=undefined;try{for(var r,s=e[Symbol.iterator]();!(o=(r=s.next()).done)&&(n.push(r.value),!t||n.length!==t);o=!0);}catch(l){i=!0,a=l}finally{try{!o&&s["return"]&&s["return"]()}finally{if(i)throw a}}return n}return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return n(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},ql={getJson:function(e){return fetch(e,{credentials:"include"}).then(status).then(json)},getHtml:function(e){return fetch(e,{credentials:"include"}).then(status).then(text)},Poller:function(e,t,n,o){this.continuePolling=!0,this.path=e,this.timeout=t,this.success=n,this.failure=o||this.defaultFailure,this.start=function i(){var t=this;this.continuePolling&&ql.getJson(this.path).then(this.success).then(function(){return setTimeout(i.bind(t),t.timeout)})["catch"](function(e){console.log(e),t.stop(),t.failure(e)})},this.once=function(){ql.getJson(this.path).then(this.success)["catch"](this.failure)},this.stop=function(){this.continuePolling=!1},this.defaultFailure=function(e){console.log("Request failed",e)}},events:{},subscribe:function(t,n){return ql.events[t]=ql.events[t]||[],ql.events[t].push(n),{unsubscibe:function o(){var e=ql.events[t].indexOf(n);ql.events[t].splice(e,1)}}},publish:function(e,t){ql.events[e]&&ql.events[e].forEach(function(e){e.call(this,t)})},debounce:function(i,e,t){var a,r=arguments.length<=1||e===undefined?20:e,s=arguments.length<=2||t===undefined||t;return function(){var e=this,t=arguments,n=function n(){a=null,s||i.apply(e,t)},o=s&&!a;clearTimeout(a),a=setTimeout(n,r),o&&i.apply(e,t)}},showFlash:function(e,t){var n=$("#flash-sibling-before"),o=$('<div id="flash-alert" class="alert" role="alert"></div>');"notice"==e?o.addClass("alert-success"):o.addClass("alert-error");var i=$('<a class="alert__close" data-dismiss="alert" aria-labelledby="flash-alert"><i class="fa fa-times"></i></a>'),a=$('<iframe class="l-ie-iframe-fix" tabindex="-1"></iframe>');o.text(t),o.append(i),o.append(a),$(".alert").remove(),o.insertAfter(n)},moveFlash:function(e){$(function(){return $("#flash-sibling-before").insertAfter(e)})}};$.widget("custom.userAutocomplete",$.ui.autocomplete,{_renderItem:function _renderItem(e,t){return $("<li>").attr("data-value",t.value).append(ql.renderAutocompleteUser(t)).appendTo(e)}}),ql.renderAutocompleteUser=function(e){return"newUser"==e.value?'<div class="add-new-user js-add-new-user">\n      <i class="material-icons">add</i> Add New User\n    </div>':"<div class='autocomplete--user'>\n      <img src='https://secure.gravatar.com/avatar/"+e.label.gravatar_hash+".jpg?s=80&d=mm'/>\n      <div>\n        "+e.label.email+"\n        <span>"+e.label.first_name+" "+e.label.last_name+"</span>\n      </div>\n    </div>"},ql.autocomplete=function(){function e(){$(".js-user-autocomplete").userAutocomplete({source:t}),$(document).on("nested:fieldAdded",function(e){e.field.find(".js-user-autocomplete").userAutocomplete({source:t})})}function t(e,t){var n="?q["+this.element[0].dataset.query+"]="+e.term;ql.getJson(this.element[0].dataset.autocomplete+n).then(function(e){t(e.map(function(e){return{label:e,value:e.email}}))})}return{init:e,source:t}}(),ql.setCookie=function(e,t,n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);var i="expires="+o.toUTCString();document.cookie=e+"="+t+";"+i+";path=/"},ql.hasAnalytics=function(){return"undefined"!=typeof analytics},ql.track=function(e,t){var n=arguments.length<=1||t===undefined?{}:t;ql.hasAnalytics()&&(analytics.track(e,n),dataLayer.push(_extends({event:e},n)))},ql.experiments=function(){function n(t){return o.find(function(e){return e.id===t})}function e(){return o}function t(e){var t=n(e);return null!=e&&t.variant}var o=[],i=document.querySelector('meta[name="active-experiments"]');if(i)try{o=JSON.parse(i.content)}catch(a){console.error(a)}else console.error("Missing active-experiments meta tag.");return{getActiveExperiments:e,getExperiment:n,getUserVariant:t}}(),ql.adminClassroomView=function(){function e(e){n=e,o=document.querySelector(".js-classroom-focuses"),t()}function t(){ql.getJson(n).then(function(e){return o.innerHTML=e.focuses}).then(function(){return setTimeout(t,1e4)})["catch"](function(e){return console.error(e.message)})}var n="",o="";return{init:e}}(),ql.analytics=function(){function e(){function l(e){var t=!0,n=!1,o=undefined;try{for(var i,a=e.querySelectorAll("*")[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var r=i.value;r.dataset&&null!=r.dataset.analyticsAction&&r.addEventListener("click",c,!1),r.shadowRoot&&l(r.shadowRoot)}}catch(s){n=!0,o=s}finally{try{!t&&a["return"]&&a["return"]()}finally{if(n)throw o}}}l(document)}function c(){ql.track(this.dataset.analyticsAction,_extends({category:this.dataset.analyticsCategory,label:this.dataset.analyticsLabel},this.dataset))}return{init:e}}(),ql.assessmentTimer=function(){function e(){var o=document.querySelector("ql-quiz"),i=document.querySelector("ql-exam-timer"),t=document.querySelector(".assessment-timer"),e=document.querySelector(".timer-toggle"),a=function a(){null==i.getAttribute("open")&&(i.setAttribute("open","true"),setTimeout(function(){return i.removeAttribute("open")},5*s))},r=function r(e){var t=e.detail,n=i.classList;t<=0&&!n.contains("expired")?(o.dispatchEvent(new Event("timeElapsed")),n.add("expired"),i.setAttribute("open","true")):t<=30&&!n.contains("critical")?(n.add("critical"),a()):t<15*l&&!n.contains("warning")&&(n.add("warning"),a())},n=function n(e){switch(e.type){case c.RETAKE:i.startedAt=e.detail,i.setAttribute("open","true"),i.classList.remove("expired","critical","warning"),t.classList.remove("hidden");break;case c.SUBMIT:i.startedAt=null,t.classList.add("hidden")}};o&&i&&e&&(i.addEventListener("secondsRemainingChanged",r),o.addEventListener(c.SUBMIT,n),o.addEventListener(c.RETAKE,n))}var s=1e3,l=60,c={RETAKE:"retake",SUBMIT:"submit"};return{init:e}}(),CampaignCodeModalSubmitEnable=function(){$("#campaign-code-modal-submit").prop("disabled",!1)},CampaignCodeModalSubmitDisable=function(){$("#campaign-code-modal-submit").prop("disabled",!0)},ql.catalogs={tracking:function(){function e(){document.querySelectorAll(".js-catalog-item-title a").forEach(function(e){return e.addEventListener("click",function(e){ql.track("clicked_catalog_list_item",{label:e.target.innerText,type:e.target.dataset.type})},!1)})}return{init:e}}(),addItems:function(){function e(){$catalogItems=document.querySelector(".js-catalog-items"),$addButtons=document.querySelectorAll(".js-add-button"),$addButtons.forEach(function(e){e.addEventListener("click",t,!1)}),ql.subscribe("itemAdded",o)}function t(e){e.preventDefault(),e.stopImmediatePropagation(),$("#add_item_with_children").modal("hide"),n(this.href)}function n(e){fetch(e,{method:"POST",credentials:"include",headers:new Headers({"X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').content,Accept:"application/json","Content-Type":"application/json"})}).then(status).then(json).then(function(e){return ql.publish("itemAdded",e)})["catch"](function(e){return console.log(e)})}function o(e){$firstCatalogItem=$catalogItems.querySelectorAll(".js-catalog-item")[0],$firstCatalogItem?$firstCatalogItem.insertAdjacentHTML("beforebegin",e.html):$catalogItems.insertAdjacentHTML("beforeend",e.html),$visiblebuttons=$catalogItems.querySelectorAll(".js-item-visible"),$visiblebuttons.forEach(function(e){e.hasAttribute("data-listening")||ql.catalogs.editItems.upgradeVisibleButton(e)}),$priceFields=$catalogItems.querySelectorAll(".js-item-price"),$priceFields.forEach(function(e){e.hasAttribute("data-listening")||ql.catalogs.editItems.upgradePriceField(e)}),$oldItem=document.querySelector('.js-add-item[data-item="'+e.catalogableType+"_"+e.catalogableId+'"]'),$($oldItem).animate({height:0},200,function(){$oldItem.remove()})}return $addButtons=[],$catalogItems={},{init:e,addItem:n}}(),searchItems:function(){function e(){$active=window.localStorage.getItem("searchTab")?window.localStorage.getItem("searchTab"):"Labs",t(".js-tab"),t(".js-tab-content"),n(),$tabsContainer=document.querySelector(".js-catalogable-types"),$tabsContainer.addEventListener("click",o)}function t(e){$tabs=document.querySelectorAll(e),$tabs.forEach(function(e){e&&(e.dataset.tab==$active?e.classList.add("is-active"):e.classList.remove("is-active"))})}function n(){$paginationContainers=document.querySelectorAll(".pagination"),$paginationContainers.forEach(function(e){e&&(e.id!=$active.toLowerCase()?e.style.display="none":e.style.display="inline")})}function o(){$active=document.querySelector(".js-tab.is-active").dataset.tab,window.localStorage.setItem("searchTab",$active),n()}return{init:e}}(),dragAndDrop:function(){function e(){$modal=document.querySelector("#add_item_with_children"),$name=$modal.querySelector(".js-add-item-name"),$type=$modal.querySelector(".js-add-item-type"),$count=$modal.querySelector(".js-add-item-children-count"),$with_button=$modal.querySelector(".js-with-children"),$without_button=$modal.querySelector(".js-without-children"),$(".js-add-item").draggable({helper:"clone",appendTo:"body"}),$(".js-catalog-table").droppable({drop:t,activeClass:"is-droppable",hoverClass:"is-active"})}function t(e,t){var n=t.draggable[0];if(n.dataset.hasChildren){var o=n.dataset.name,i=n.dataset.type,a=n.dataset.children,r=n.querySelector(".js-add-with-children").href,s=n.querySelector(".js-add-without-children").href;$name.innerHTML=o,$type.innerHTML=i,$count.innerHTML=a,$with_button.href=r,$without_button.href=s,$("#add_item_with_children").modal("show")}else $addButton=n.querySelector(".js-add-button"),ql.catalogs.addItems.addItem($addButton.href)}return $addItems={},$modal={},$name={},$type={},$count={},$with_button={},$without_button={},{init:e}}(),editItems:function(){function e(){$catalogItems=document.querySelector(".js-catalog-items"),$visibleButtons=$catalogItems.querySelectorAll(".js-item-visible"),$visibleButtons.forEach(t),$priceFields=$catalogItems.querySelectorAll(".js-item-price"),$priceFields.forEach(n),ql.subscribe("itemUpdated",r)}function t(e){e.addEventListener("click",o,!1),e.dataset.listening="true"}function n(e){e.addEventListener("change",i,!1),e.dataset.listening="true"}function o(e){e.preventDefault(),e.stopImmediatePropagation(),a(this.href)}function i(){a(this.dataset.path.replace(/=.*/i,"="+this.value))}function a(e){fetch(e,{method:"PATCH",credentials:"include",headers:new Headers({"X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').content,Accept:"application/json","Content-Type":"application/json"})}).then(status).then(json).then(function(e){return ql.publish("itemUpdated",e)})["catch"](function(e){return console.log(e)})}function r(e){$item=$catalogItems.querySelector('[data-item = "'+e.id+'"]'),$visibleButton=$item.querySelector(".js-item-visible");var t=e.visible?"0":"1",n=e.visible?"text--success":"text--light",o=$visibleButton.href.replace(/=\d/i,"="+t);$visibleButton.href=o,$visibleButton.classList.remove("text--success"),$visibleButton.classList.remove("text--light"),$visibleButton.classList.add(n),e.price&&($priceField=$item.querySelector(".js-item-price"),$priceField.value=e.price)}return $catalogItems={},$visibleButtons={},$priceFields={},{init:e,upgradeVisibleButton:t,upgradePriceField:n}}(),edit:function(){function e(){$enableButton=document.querySelector(".js-enable-catalog"),$enableIcon=$enableButton.querySelector(".material-icons"),$enableButton.addEventListener("click",t,!1),$fraudButton=document.querySelector(".js-fraud-catalog"),$fraudIcon=$fraudButton.querySelector(".material-icons"),$fraudButton.addEventListener("click",t,!1),ql.subscribe("catalogUpdated",o)}function t(e){e.preventDefault(),e.stopImmediatePropagation(),n(this.href)}function n(e){fetch(e,{method:"PATCH",credentials:"include",headers:new Headers({"X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').content,Accept:"application/json","Content-Type":"application/json"})}).then(status).then(json).then(function(e){return ql.publish("catalogUpdated",e)})["catch"](function(e){return console.log(e)})}function o(e){var t=e.enabled_at?"0":"1",n=e.enabled_at?"check_box":"check_box_outline_blank",o=$enableButton.href.replace(/=\d/i,"="+t);$enableButton.href=o,$enableIcon.innerHTML=n;var i=e.fraud_protection?"0":"1",a=e.fraud_protection?"check_box":"check_box_outline_blank",r=$fraudButton.href.replace(/=\d/i,"="+i);$fraudButton.href=r,$fraudIcon.innerHTML=a}return $enableButton={},$enableIcon={},$fraudButton={},$fraudIcon={},{init:e}}(),description:function(){function e(e,t,n){document.getElementById(e).checked?document.getElementById("label_"+e).innerHTML=t:document.getElementById("label_"+e).innerHTML=n}return{checkboxState:e}}()},ql.catalogAccessBulkRemoval=function(t){function e(){document.querySelector(".js-start-dry-run").addEventListener("click",d),ql.subscribe(A,r),ql.subscribe(E,s)}function n(e){b(),o(e)}function o(e){(I=new ql.Poller(e,t,function(e){ql.publish(A,e)})).start()}function i(e){y(),a(e)}function a(e){C===undefined&&(C=new ql.Poller(e,t,function(e){ql.publish(E,e)})).start()}function r(e){e&&null===e.dry_run_operation?window.location=e.redirect_path:e&&"finished"===e.dry_run_operation.status&&(I.stop(),v(),e.dry_run_operation.succeeded?c(e):S())}function s(e){e&&null===e.removal_operation?window.location=e.redirect_path:e&&"finished"===e.removal_operation.status&&(C.stop(),g(),e.removal_operation.succeeded?window.location=e.redirect_path:l())}function l(){document.querySelector(".removal-dry-run-summary").classList.contains("is-active")?w():S()}function c(e){document.querySelector(".removal-dry-run-summary").innerHTML=e.rendered,u(),document.querySelector(".removal-dry-run-summary").classList.add("is-active"),j()}function u(){document.querySelector(".js-confirm-removal-button").addEventListener("click",m),document.querySelector(".js-cancel-bulk-removal").addEventListener("click",f),$confirmButtonForm=$(".js-confirm-removal-form"),$confirmButtonForm.on("ajax:success",function(e,t){p(),a(t.removal_status_path+"?removal_operation_id="+t.removal_operation_id)}),$confirmButtonForm.on("ajax:error",function(e,t){return window.location=t.responseJSON.redirect_path,!1})}function d(){b(),h()}function m(){q(),L()}function f(){_(),h(),p()}function h(){I&&(I.stop(),I=undefined)}function p(){C&&(C.stop(),C=undefined)}function b(){document.querySelector(".dry-run-loader").classList.add("is-active"),document.querySelector(".removal-general-error").classList.remove("is-active"),j()}function v(){document.querySelector(".dry-run-loader").classList.remove("is-active")}function y(){document.querySelector(".removal-loader").classList.add("is-active"),j()}function g(){document.querySelector(".removal-loader").classList.remove("is-active")}function _(){document.querySelector(".removal-dry-run-summary").classList.remove("is-active"),k()}function q(){document.querySelector(".removal-spinner").classList.add("is-active"),document.querySelector(".removal-actions").classList.add("disabled")}function w(){document.querySelector(".removal-confirmation-error").classList.add("is-active"),document.querySelector(".removal-spinner").classList.remove("is-active"),document.querySelector(".removal-actions").classList.remove("disabled")}function L(){document.querySelector(".removal-confirmation-error").classList.remove("is-active")}function S(){document.querySelector(".removal-general-error").classList.add("is-active"),k()}function j(){document.querySelector(".removal-upload-form").classList.add("disabled")}function k(){document.querySelector(".removal-upload-form").classList.remove("disabled")}var A="received-dry-run-status",E="received-removal-status",I=undefined,C=undefined;return{init:e,pollDryRunOnPageLoad:n,pollRemovalOnPageLoad:i}},ql.chat=function(){function e(){i(),zE("webWidget:on","close",n)}function t(){o(),zE("webWidget","open")}function n(){zE("webWidget","close"),i()}function o(){zE("webWidget","show")}function i(){zE("webWidget","hide")}return{init:e,open:t,close:n,show:o,hide:i}}(),initChosenListener=function(){$(".js-chosen").chosen({disable_search_threshold:20})},initChosen=function(){initChosenListener()},ql.focusDataPath="",ql.initStudentCheckBoxListeners=function(){var e=document.querySelectorAll(".js-select-student");[].concat(_toConsumableArray(e)).map(function(e){e.addEventListener("click",ql.handleStudentCheckBox)})},ql.handleStudentCheckBox=function(){ql.toggleStudentRow(this.closest("[data-student]")),ql.toggleStudentCheckBox(this),ql.toggleActionButtons()},ql.toggleStudentRow=function(e){e.classList.toggle("is-selected")},ql.toggleStudentCheckBox=function(e){e.innerHTML=e.innerHTML.includes("blank")?"check_box":"check_box_outline_blank"},ql.toggleActionButtons=function(){var e=ql.getSelectedStudentRows(),t=e.filter(function(e){return"true"==e.dataset.running}),n=document.querySelector(".js-student-table-title"),o=document.querySelector(".js-student-actions-container"),i=o.querySelectorAll(".mdl-button");e.length?(n.style.display="none",o.style.display="block",0==t.length?i.forEach(function(e){return e.classList.add("mdl-button--disabled")}):i.forEach(function(e){return e.classList.remove("mdl-button--disabled")})):(n.style.display="flex",o.style.display="none")},ql.getSelectedStudentRows=function(){var e=document.querySelectorAll("[data-student]");return[].concat(_toConsumableArray(e)).filter(function(e){return e.classList.contains("is-selected")})},ql.initAddTimeListener=function(){document.querySelector(".js-add-time").addEventListener("click",ql.handleAddTime)},ql.handleAddTime=function(){ql.getSelectedStudentRows().filter(function(e){return"true"==e.dataset.running}).map(function(e){return e.dataset.addTimePath}).map(function(e){var t=new Request(e,{method:"POST",credentials:"include",headers:new Headers({"X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').content})});fetch(t).then(status).then(json).then(function(){return ql.getJson(ql.focusDataPath).then(function(e){return ql.publish("received-focus-data",e)})})["catch"](function(e){return console.log("Request failed",e)})})},ql.initEndLabListener=function(){document.querySelector(".js-end-lab").addEventListener("click",ql.handleEndLab)},ql.handleEndLab=function(){ql.getSelectedStudentRows().filter(function(e){return"true"==e.dataset.running}).map(function(e){return e.dataset.endLabPath}).map(function(e){fetch(e,{credentials:"include"}).then(status).then(json).then(function(){return ql.getJson(ql.focusDataPath).then(function(e){return ql.publish("received-focus-data",e)})})["catch"](function(e){return console.log("Request failed",e)})})},ql.trainerClassroomView=function(){function t(e){e.students.forEach(function(e){var t=document.querySelector('[data-student="'+e.id+'"]');(t.dataset.labInstance=e.lab_instance.id,t.dataset.labState=e.lab_instance.lab_state,t.dataset.running=e.lab_instance.running,t.dataset.addTimePath=e.lab_instance.add_time_path,t.dataset.endLabPath=e.lab_instance.end_lab_path,t.querySelector(".js-status").innerHTML=e.lab_instance.status_html,e.lab_instance.score_html)&&(t.querySelector(".js-score").innerHTML=e.lab_instance.score_html)})}function n(e){e.running_hotlabs&&e.running_hotlabs.forEach(function(e){var t=document.querySelector("#focus_"+e.id).querySelector(".js-lab-details");0<e.hotlabs_running_count?t.innerHTML=e.hotlabs_running_count+" labs pre-warmed.":t.innerHTML=""})}function o(e){r&&(r.innerHTML=e.hotlabs_status)}function i(e){if(b){b.innerHTML=e.hotlabs_button;var t=b.querySelectorAll(".mdl-button"),n=!0,o=!1,i=undefined;try{for(var a,r=t[Symbol.iterator]();!(n=(a=r.next()).done);n=!0){var s=a.value;componentHandler.upgradeElement(s)}}catch(p){o=!0,i=p}finally{try{!n&&r["return"]&&r["return"]()}finally{if(o)throw i}}var l=b.querySelectorAll(".mdl-tooltip"),c=!0,u=!1,d=undefined;try{for(var m,f=l[Symbol.iterator]();!(c=(m=f.next()).done);c=!0){var h=m.value;componentHandler.upgradeElement(h)}}catch(p){u=!0,d=p}finally{try{!c&&f["return"]&&f["return"]()}finally{if(u)throw d}}}}function a(){ql.getJson(ql.focusDataPath).then(function(e){return ql.publish("received-focus-data",e)}).then(function(){return setTimeout(a,5e3)})["catch"](function(e){return console.log("Request failed",e)})}var r={},b={};return{init:function s(e){ql.focusDataPath=e,r=document.querySelector(".js-hotlabs"),b=document.querySelector(".js-hotlabs-button"),ql.subscribe("received-focus-data",o),ql.subscribe("received-focus-data",i),ql.subscribe("received-focus-data",n),ql.subscribe("received-focus-data",t),a(),document.querySelector("a.classroom__index-item.active").scrollIntoView()}}}(),ql.trainerLabDragDrop=function(){function e(){$("#js-sortable").sortable({axis:"y",handle:".handle",update:function n(){if($.post($(this).data("update-url"),$(this).sortable("serialize")),0<document.querySelectorAll(".classroom_section.visible").length)for(var e=document.querySelectorAll(".classroom_section.visible #classroom-table tr.focus.classroom-tr .number_field"),t=0;t<e.length;t++)e[t].innerText=t+1+"."}})}return{init:e}}(),ql.classroomStudentView=function(){function e(e){o=e,i=document.querySelectorAll(".js-focus-row"),ql.subscribe("received-student-data",n),t()}function t(){ql.getJson(o).then(function(e){return ql.publish("received-student-data",e)}).then(function(){return setTimeout(t,5e3)})["catch"](function(e){return console.log("Request failed",e)})}function n(e){e.focuses.forEach(function(t){[].concat(_toConsumableArray(i)).filter(function(e){return e.dataset.focus==t.id}).shift().innerHTML=t.html})}var o="",i="";return{init:e}}();var initClipboardToolTips=function initClipboardToolTips(e){e.on("success",function(e){$(e.trigger).attr("title",trans.copied).tooltip("fixTitle").tooltip("show"),$(e.trigger).mouseout(function(){$(this).tooltip("hide").tooltip("destroy")})}),e.on("error",function(e){var t="";t=/iPhone|iPad/i.test(navigator.userAgent)?trans.no_support:/Mac/i.test(navigator.userAgent)?trans.mac_press:trans.windows_press,$(e.trigger).attr("title",t).tooltip("fixTitle").tooltip("show"),$(e.trigger).mouseout(function(){$(this).tooltip("hide").tooltip("destroy")})})};ql.cloudTerminal=function(){function t(e){var t=document.querySelector("#embedded-resource");null!==t&&t.src!==e&&(t.src=e)}return{update:function n(e){if(null!==e){if(!new URL(e).host.endsWith(".qwiklabs.com"))throw"studentUrl must be on a subdomain of qwiklabs.com: "+e;t(e)}},reset:function e(){t("about:blank")},isTerminalActive:function o(){var e=document.querySelector("#embedded-resource");return null!==e&&""!==e.src&&"about:blank"!==e.src}}}(),ql.collaboratorsEdit=function(){function e(){$collaboratorList=$(".js-collaborator-list"),$errorFeedback=$(".js-add-collaborator-error"),t(),n()}function t(){$(".js-add-collaborator-form").on("ajax:before",function(){$errorFeedback.empty()}).on("ajax:success",function(e,t){o(t.rendered)}).on("ajax:error",function(e,t){i(t.responseJSON)})}function n(){$(document).on("ajax:success",".js-collaborator-item",function(e){e.currentTarget.remove(),e.preventDefault()}).on("ajax:error",".js-delete-permission",function(e,t){i(t.responseJSON)})}function o(e){$collaboratorList.append(e),$collaboratorList.scrollTop($collaboratorList[0].scrollHeight),$collaboratorList.find(".mdl-list__item").last().addClass("is-new")}function i(e){errors=e.errors,errors.forEach(function(e){$errorFeedback.append("<p>"+e+"</p>")})}return $collaboratorList="",$errorFeedback="",{init:e}}(),$(function(){$(".js-accept-cookies").click(function(){document.cookie="cookie_consent= true",$(".cookie-bar").hide()})}),ql.course={schedule:function(){function e(){o=document.querySelectorAll(".js-more-details"),i=document.querySelectorAll(".js-less-details"),o.forEach(function(e){e.addEventListener("click",t,!1)}),i.forEach(function(e){e.addEventListener("click",n,!1)})}function t(e){e.preventDefault(),this.style.display="none",this.parentElement.querySelector(".js-less-details").style.display="block"}function n(e){e.preventDefault(),this.style.display="none",this.parentElement.querySelector(".js-more-details").style.display="block"}var o=undefined,i=undefined;return{init:e}}()},ql.courseVideo=function(){function e(){var e=document.querySelector("ql-youtube-video").shadowRoot.querySelector("google-youtube-player");e.addEventListener("google-youtube-ready",function(){e.addEventListener("google-youtube-state-changed",t),setInterval(n,o)})}function t(e){var t=(new Date).getTime();e.detail===YT.PlayerState.PLAYING?i=t:i&&(a+=t-i,i=null)}function n(){if(i){var e=(new Date).getTime();a+=e-i,i=e}0<a&&a<2*o&&$.post(window.location.pathname+"/viewed",{deltaTime:a}),a=0}var o=5e3,i=undefined,a=0;return{init:e}}(),ql.discovery=function(){function e(){t(".in-progress-cards .js-content-card","in-progress"),t(".favorite-cards .js-content-card","favorite"),t(".curated-cards .js-content-card","curated"),t(".featured-cards .js-content-card","featured"),t(".upcoming-cards .js-content-card","upcoming"),t(".popular-cards .js-content-card","popular")}function t(e,s){document.querySelectorAll(e).forEach(function(r){r.addEventListener("click",function(){var e=r.dataset,t=e.id,n=e.name,o=e.type,i=e.level,a=e.path;ql.track("discover_catalog_item",{label:s,id:t,name:n,type:o,level:i,path:a})})})}return{init:e}}(),ql.editV2Lab={gdoc_or_markdown:function Bg(e){"Google Doc"==e?(document.querySelector(".instructions_google_doc").style.display="block",document.querySelector(".instructions_markdown").style.display="none"):(document.querySelector(".instructions_google_doc").style.display="none",document.querySelector(".instructions_markdown").style.display="block")},switch_resource:function Cg(e){"video"==e||"link"==e?(document.querySelector(".resource_video_link").style.display="block",document.querySelector(".resource_file").style.display="none"):(document.querySelector(".resource_video_link").style.display="none",document.querySelector(".resource_file").style.display="block")},switch_lab_resource:function Dg(o,i){function e(e){var t=arguments.length<=0||e===undefined?{}:e,n=t.show_script,o=t.show_student,i=t.show_custom_ssh,a=t.show_roles,r=t.show_looker_cloud_roles,s=t.show_policy,l=t.show_allow,c=document.querySelector(".script_fields"),u=c.querySelectorAll("input"),d=document.querySelector(".student_files_fields"),m=d.querySelectorAll("input"),f=document.querySelectorAll(".custom_fields"),h=Array.from(f).reduce(function(e,t){return e.concat(Array.from(t.querySelectorAll("input")),Array.from(t.querySelectorAll("select")))},[]),p=document.querySelector(".ssh_key_user"),b=p.querySelector("select"),v=document.querySelector(".allowed_locations"),y=v.querySelector("select"),g=document.querySelector(".roles_fields"),_=[].concat(Array.from(g.querySelectorAll("input")),Array.from(g.querySelectorAll("select"))),q=document.querySelector(".looker_cloud_roles_fields"),$=[].concat(Array.from(q.querySelectorAll("input")),Array.from(q.querySelectorAll("select"))),w=document.querySelectorAll(".policy_fields"),L=Array.from(w).reduce(function(e,t){return e.concat(Array.from(t.querySelectorAll("input")),Array.from(t.querySelectorAll("textarea")))},[]);c.style.display=n?"block":"none",u.forEach(function(e){return e.disabled=!n}),d.style.display=o?"block":"none",m.forEach(function(e){return e.disabled=!o}),f.forEach(function(e){return e.style.display=i?"block":"none"}),h.forEach(function(e){return e.disabled=!i}),p.style.display=i?"block":"none",b.disabled=!i,g.style.display=a?"block":"none",_.forEach(function(e){return e.disabled=!a}),q.style.display=r?"block":"none",$.forEach(function(e){return e.disabled=!r}),w.forEach(function(e){return e.style.display=s?"block":"none"}),L.forEach(function(e){return e.disabled=!s}),v.style.display=l?"block":"none",y.disabled=!l}var a=document.getElementById("lab_lab_resources_attributes_0_resource_type"),r=document.querySelector("#lab_resource_variant"),t=r.options;Array.from(t).forEach(function(e){return e.remove(r)}),JSON.parse(a.getAttribute("data-variants"))[o].forEach(function(e,t){if("gcp_project"!=o||"gcpedu"!=e&&"gcpasl"!=e){var n=document.createElement("option");n.text=e,r.options.add(n),e==i?n.selected=!0:"nil"==i&&0==t&&(n.selected=!0)}}),"gcp_project"!=o&&"aws_account"!=o||function(){var n=document.querySelector("#resource_config_allowed_locations"),e=n.options;Array.from(e).forEach(function(e){return e.remove(n)});var t=JSON.parse(a.getAttribute("data-allowed-locations"));JSON.parse(a.getAttribute("data-all-allowed-locations"))[o].forEach(function(e){var t=document.createElement("option");t.text=e,n.options.add(t)}),$(document).find("#resource_config_allowed_locations").val(t).trigger("chosen:updated")}(),resource_display_settings={gcp_project:{show_script:!0,show_student:!1,show_custom_ssh:!0,show_roles:!1,show_looker_cloud_roles:!1,show_policy:!1,show_allow:!0},linux_terminal:{show_script:!0,show_student:!1,show_custom_ssh:!1,show_roles:!1,show_looker_cloud_roles:!1,show_policy:!1,show_allow:!1},windows_vm:{show_script:!0,show_student:!1,show_custom_ssh:!1,show_roles:!1,show_looker_cloud_roles:!1,show_policy:!1,show_allow:!1},ide:{show_script:!0,show_student:!0,show_custom_ssh:!1,show_roles:!1,show_looker_cloud_roles:!1,show_policy:!1,show_allow:!1},gcp_user:{show_script:!1,show_student:!1,show_custom_ssh:!1,show_roles:!0,show_looker_cloud_roles:!1,show_policy:!1,show_allow:!1},aws_account:{show_script:!0,show_student:!1,show_custom_ssh:!1,show_roles:!1,show_looker_cloud_roles:!1,show_policy:!0,show_allow:!0},google_workspace_domain:{show_script:!1,show_student:!1,show_custom_ssh:!1,show_roles:!1,show_looker_cloud_roles:!1,show_policy:!1,show_allow:!1},looker_instance:{show_script:!0,show_student:!1,show_custom_ssh:!1,show_roles:!1,show_looker_cloud_roles:!0,show_policy:!1,show_allow:!1},cloud_terminal:{show_script:!0,show_student:!1,show_custom_ssh:!1,show_roles:!1,show_looker_cloud_roles:!0,show_policy:!1,show_allow:!1}},e(resource_display_settings[o])},hide_document:function Eg(e){script=document.getElementById(e),script&&(script.style.display="none")},update_script_state:function Fg(e,t,n){if(document.getElementById(e).value=t,ql.editV2Lab.hide_document(n),e.includes("student_files_")&&!document.getElementById("lab_lab_resources_attributes_0_student_files").value){var o=Array.from(document.getElementById("student_files").children).filter(function(e){return"hidden"==e.type});document.getElementById("resource_config_student_files_all").value=o.reduce(function(e,t){return e||"true"==t.value},!1)}},add_custom_properties:function Gg(e){var t=document.createElement("div");t.className="form-row";var n=Date.now(),o=e+"_custom_property_"+n;t.setAttribute("id",o);var i=document.createElement("div");i.classList.add("control-group","text");var a=document.createElement("Label");a.className="label",a.setAttribute("for","key"),a.innerHTML="Key";var r=document.createElement("input");r.className="input",r.setAttribute("id","key"),r.setAttribute("required",!0),r.setAttribute("name","resource_config["+e+"_custom_properties]["+n+"][key]"),i.appendChild(a),i.appendChild(r);var s=document.createElement("div");s.classList.add("control-group","text");var l=document.createElement("Label");l.className="label",l.setAttribute("for","resource_config_"+e+"_custom_properties_"+n+"_value"),l.innerHTML="Reference / Value";var c=document.createElement("Select"),u=document.getElementById(
"lab_lab_resources_attributes_0_start_script");JSON.parse(u.getAttribute("data-options")).forEach(function(e){var t=document.createElement("option");t.text=e,c.appendChild(t)});var d="resource_config["+e+"_custom_properties]["+n+"][value]",m="resource_config_"+e+"_custom_properties_"+n+"_value";c.className="input",c.setAttribute("id",m),c.setAttribute("required",!0),c.setAttribute("name",d),s.appendChild(l),s.appendChild(c);var f=document.createElement("div");f.classList.add("control-group","text");var h=document.createElement("Label");h.className="label",h.setAttribute("for","property_type"),h.innerHTML="Type";var p=document.createElement("Select");p.className="input",p.setAttribute("id","property_type"),p.setAttribute("name","resource_config["+e+"_custom_properties]["+n+"][type]"),p.setAttribute("onchange","ql.editV2Lab.switch_custom_property_type('"+m+"', '"+d+"', this.value)");var b=document.createElement("option");b.text="reference",p.appendChild(b);var v=document.createElement("option");v.text="value",p.appendChild(v),f.appendChild(h),f.appendChild(p);var y=document.createElement("ql-icon-button");y.setAttribute("onclick","ql.editV2Lab.delete_element('"+o+"')"),y.setAttribute("icon","delete"),y.classList.add("link--danger"),t.appendChild(i),t.appendChild(s),t.appendChild(f),t.appendChild(y),document.getElementById(e+"_add_custom_property").before(t)},delete_element:function Hg(e){var t=document.getElementById(e);t.parentNode.removeChild(t)},set_duration:function Ig(e,t,n){var o=document.getElementById(e),i=document.getElementById(t);document.getElementById(n).value=60*i.value||60*o.value*1.5},switch_positions:function Jg(e,t){var n=document.querySelector(".edit_lab").querySelectorAll("form > .fields");n.forEach(function(e,t){return e.children[2].value=t});for(var o=0;o<n.length;o+=1)if(null!=n[o].querySelector("#lab_environment_outputs_attributes_"+e+"_position")){if(0==o&&-1==t)break;if(o==n.length-1&&1==t)break;n[o].children[2].value=o+t,n[o+t].children[2].value=o,-1==t?n[o].parentNode.insertBefore(n[o],n[o+t]):1==t&&n[o].parentNode.insertBefore(n[o+t],n[o]);break}},add_output:function Kg(e){document.getElementById("add_output_button").click();var t=document.querySelector(".edit_lab").querySelectorAll("form > .fields");t[t.length-1].querySelector(".lab_environment_outputs_reference").querySelector("input").value=e},switch_step_positions:function Lg(e,t){for(var n=document.querySelector(".edit_assessment_manual").getElementsByClassName("fields"),o=document.querySelector("table").querySelectorAll("tr"),i=0;i<n.length;i+=1)if(null!=n[i].querySelector("#assessment_manual_steps_attributes_"+e+"_step_no")){if(0==i&&-1==t)break;if(i==n.length-1&&1==t)break;n[i].children[1].value=i+1+t,n[i+t].children[1].value=i+1,o[i+1].children[0].innerHTML=i+1+t,o[i+1+t].children[0].innerHTML=i+1,-1==t?(n[i].parentNode.insertBefore(n[i],n[i+t]),o[i+1].parentNode.insertBefore(o[i+1],o[i+1+t])):1==t&&(n[i].parentNode.insertBefore(n[i+t],n[i]),o[i+1].parentNode.insertBefore(o[i+1+t],o[i+1]));break}},add_student_message:function Mg(e){var t=document.createElement("div");t.classList.add("form-row","form-row--max_width");var n=Date.now(),o="student_message_"+n;t.setAttribute("id",o);var i=document.createElement("div");i.classList.add("control-group","text");var a=document.createElement("Label");a.className="label",a.setAttribute("for","locales["+e+"]["+n+"][message_id]"),a.innerHTML="Message Id",i.appendChild(a);var r=document.createElement("Input");r.className="input",r.setAttribute("id","locales["+e+"]["+n+"][message_id]"),r.setAttribute("name","locales["+e+"]["+n+"][message_id]"),r.setAttribute("required",!0),i.appendChild(r),t.appendChild(i);var s=document.createElement("div");s.classList.add("control-group","text");var l=document.createElement("Label");l.className="label",l.setAttribute("for","locales["+e+"]["+n+"][message]"),l.innerHTML="Message",s.appendChild(l);var c=document.createElement("Input");c.className="input",c.setAttribute("id","locales["+e+"]["+n+"][message]"),c.setAttribute("name","locales["+e+"]["+n+"][message]"),c.setAttribute("required",!0),s.appendChild(c),t.appendChild(s);var u=document.createElement("ql-icon-button");u.setAttribute("onclick","ql.editV2Lab.delete_element('"+o+"')"),u.setAttribute("icon","delete"),u.classList.add("text--error"),t.appendChild(u),document.getElementById("add-student-message").before(t)},add_default_outputs:function Ng(){var e=document.getElementById("default_button"),a=document.getElementById("add_output_button"),r={console_url:1,username:2,password:3,project_id:4},s={console_url:console_url_label,username:username_label,password:password_label,project_id:project_id_label},t=JSON.parse(e.getAttribute("data-options"));t.sort(function(e,t){var n=e.split(".")[1],o=t.split(".")[1];return(r[n]||5)-(r[o]||5)}),t.forEach(function(e){var t=e.split(".")[1];if(Object.keys(r).includes(t)){a.click();var n=document.querySelector(".edit_lab"),o=n.querySelectorAll("form > .fields"),i=n.querySelectorAll("textarea");o[o.length-1].querySelector(".lab_environment_outputs_reference").querySelector("input").value=e,i[i.length-1].value=s[t]}})},switch_custom_property_type:function Og(e,t,n){var o=document.getElementById(e),i=null;if("value"==n)i=document.createElement("input");else if("reference"==n){var a=document.getElementById("lab_lab_resources_attributes_0_start_script"),r=JSON.parse(a.getAttribute("data-options"));i=document.createElement("Select"),r.forEach(function(e){var t=document.createElement("option");t.text=e,i.appendChild(t)})}null!=i&&(i.className="input",i.setAttribute("id",e),i.setAttribute("required",!0),i.setAttribute("name",t),o.parentNode.insertBefore(i,o),o.parentNode.removeChild(o))}},ql.exam=function(){function e(){setInterval(function(){$.get(window.location.pathname+"/status").fail(function(){return window.location.reload()})},5e3),document.querySelector("ql-quiz").addEventListener("submit",function(){return window.location.reload()})}return{init:e}}(),ql.favoriting=function(){function e(){document.querySelectorAll(".js-favorite-button").forEach(function(e){e.addEventListener("click",t,!1)})}function t(e){e.preventDefault(),e.stopImmediatePropagation(),n.call(this),i.call(this)}function n(){var e=o(this.dataset.type),t=this.dataset.name;this.href.includes("unfavorite")?ql.track("clicked_unfavorite_button",{type:e,label:t}):ql.track("clicked_favorite_button",{type:e,label:t})}function o(e){var t=undefined;switch(e){case"CatalogItem":t="Lab";break;case"LearningPath":t="Quest";break;case"ClassroomTemplate":t="Course";break;default:cateogry=e}return t}function i(){var t=this,e=new Request(this.href,{method:"POST",credentials:"include",headers:new Headers({"X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').content})});fetch(e).then(status).then(json).then(function(e){console.log(e),e.alert?console.error(e.alert):(t.setAttribute("href",e.path),t.setAttribute("tip",e.tooltip),t.setAttribute("aria-label",e.tooltip),t.innerHTML=e.icon,$card=t.closest(".js-content-card"),$card&&$card.classList.toggle("is-unfavorited"))})}return{init:e}}(),ql.filter={filter:function(){function e(){$form=document.querySelector(".js-filter-form"),$form&&($inputs=$form.querySelectorAll("input"),$inputs.forEach(function(e){return e.addEventListener("click",t)}))}function t(e){var t="any",n=e.currentTarget.closest(".js-list-item"),o=n.querySelector('input[value="'+t+'"]');e.currentTarget.value===t?n.querySelectorAll('input:checked:not([value="'+t+'"])').forEach(function(e){r(e)}):o.checked&&r(o),n.querySelectorAll("input:checked").length||a(o),numActive=n.querySelectorAll('input:checked:not([value="'+t+'"])').length;var i=numActive?"("+numActive+")":"";n.querySelector(".active-filter-number").textContent=i,ql.track(this.checked?"checked_filter":"unchecked_filter",{label:this.id}),ql.searchFilter()}function n(e){return e.closest(".mdl-checkbox")}function a(e){n(e).classList.add("is-checked"),e.checked=!0}function r(e){n(e).classList.remove("is-checked"),e.checked=!1}return $form={},{init:e}}()},ql.searchFilter=function(){var e=document.querySelector(".js-filter-form"),t=document.querySelector(".js-search-form");return e?(t&&(e.querySelector("input[name='keywords']").value=t.querySelector("input[name='keywords']").value,e.querySelector("input[name='locale']").value=t.querySelector("input[name='locale']").value),document.querySelector(".js-custom-filter-form")||e.submit()):t&&t.submit(),!1},ql.game=function(){function e(e){var t=document.querySelector(".js-lab-leaderboard");null!=e&&null!=t&&(t.players=JSON.parse(e))}return{updateLabLeaderboard:e}}(),ql.header={myAccount:function(){function e(){n=document.querySelector(".js-my-account-menu"),o=document.querySelector(".js-main"),n&&($myAccountButton=document.querySelector(".js-my-account-button"),$myAccountButton.addEventListener("click",t,!1))}function t(){n.classList.toggle("is-open")?(ql.track("opened_my_account_menu"),o.addEventListener("click",t,!1)):o.removeEventListener("click",t,!1)}var n=undefined,o=undefined;return{init:e}}()},function(n){function o(e,t){this.instructionId=e,this.refreshPage=t,this.refreshing=!1,this.refresh=function(){var t=this;this.refreshing?console.log("Already polling. Ignoring this refresh."):(this.startRefreshing(),$.post("/authoring/instructions/"+this.instructionId+"/refresh.json").done(function(){setTimeout(function(){return t.pollStatus()},2e3)}).fail(function(e){console.log(e),t.stopRefreshing()}))},this.pollStatus=function(){var t=this;n.getJson("/instructions/"+this.instructionId+"/status.json").then(function(e){"failed"==e.state?(n.showFlash("error",e.message),t.stopRefreshing()):"completed"==e.state?(n.showFlash("notice",e.message),t.refreshPage?window.location.reload():t.stopRefreshing()):setTimeout(function(){return t.pollStatus()},5e3)})["catch"](function(e){t.stopRefreshing(),console.log(e)})},this.startRefreshing=function(){var e=this.instructionId;this.refreshing=!0,$(".refresh-instruction-spinner-"+e).removeClass("hidden"),$(".refresh-instruction-button-"+e).addClass("hidden")},this.stopRefreshing=function(){var e=this.instructionId;this.refreshing=!1,$(".refresh-instruction-spinner-"+e).addClass("hidden"),$(".refresh-instruction-button-"+e).removeClass("hidden")}}n.refreshInstruction=function(e,t){new o(e,t).refresh()}}(ql),ql.instructionVariables={update:function Kk(t){document.querySelectorAll("ql-variable,ql-code-block").forEach(function(e){return e.load(t)})},reset:function Lk(){document.querySelectorAll("ql-variable,ql-code-block").forEach(function(e){return e.load()})}},ql.courseOutline=function(){function e(){var e=document.querySelector(".course-instructor-outline-drawer"),t=e.querySelector(".outline__course").querySelector(".active").parentElement,n=t.classList,o=undefined;n.contains("course-header")?o=t.closest(".outline__course"):n.contains("module-header")?o=t.closest(".outline__module"):n.contains("activity-header")&&(o=t.closest(".outline__activity")),o&&document.body.clientHeight/2<o.offsetTop-t.offsetHeight&&(e.scrollTop=o.offsetTop-t.offsetHeight)}return{init:e}}(),ql.jumpContent=function(){function e(){document.addEventListener("jumpContent",t)}function t(){var e=document.getElementById("jump-content");e.focus(),e.setAttribute("tabindex","0")}return{init:e}}(),initLaunchWithSubscriptionButtonListener=function(){$(".js-launch-with-subscription-button").click(function(){$(this).attr("disabled")||($(".js-launch-with-credits-input").val(0),$(".js-launch-with-subscription-input").val(1),$(".js-launch-with-access-code").val(0),submitLabAccessForm())})},initLaunchWithCreditsButtonListener=function(){$(".js-launch-with-credits-button").click(function(){$(this).attr("disabled")||($(".js-launch-with-credits-input").val(1),$(".js-launch-with-subscription-input").val(0),$(".js-launch-with-access-code").val(0),submitLabAccessForm())})},initLaunchWithAccessCodeButtonListener=function(){$(".js-launch-with-access-code-button").click(function(){$(this).attr("disabled")||($(".js-launch-with-credits-input").val(0),$(".js-launch-with-subscription-input").val(0),$(".js-launch-with-access-code").val(1),submitLabAccessForm())})},initLaunchButtonListener=function(){$(".js-launch-button").click(function(){$(this).attr("disabled")||($(".js-launch-with-credits-input").val(0),$(".js-launch-with-subscription-input").val(0),$(".js-launch-with-access-code").val(0),submitLabAccessForm())})},initLabAccessFormListener=function(){$(".js-lab-access-form").on("ajax:success",function(){ql.labRun.startLab({accessSuccess:!0})}).on("ajax:error",function(e,t){$(".js-access-code input").val(""),alertLabAccessError(t.responseText),ql.labControlPanel.reset()}).on("ajax:complete",function(){enableLabAccessModalButtons()})},initAutoTabAccessCode=function(){var t=0;$(".js-access-code-input").on("keyup",function(e){8===e.keyCode&0===t&&$(this).prev(".js-access-code-input").focus(),t=this.value.length}),$(".js-access-code-input").on("input",function(){this.value.length===this.maxLength&&($(this).next(".js-access-code-input").focus(),t=0)})},submitLabAccessForm=function(){disableLabAccessModalButtons(),$(".js-lab-access-form").submit(),$("#lab-access-modal").modal("hide"),ql.labControlPanel.setStarting()},alertLabAccessError=function(e){$("#lab-access-modal").modal("hide"),$(".js-alert-message").html(e),$(".js-alert").removeClass("alert-success").addClass("alert-error").css("display","flex")},disableLabAccessModalButtons=function(){$(".js-lab-access-modal-button").attr("disabled",!0)},enableLabAccessModalButtons=function(){$(".js-lab-access-modal-button").attr("disabled",!1)},initLabAccessModal=function(){initLaunchWithSubscriptionButtonListener(),initLaunchWithCreditsButtonListener(),initLaunchWithAccessCodeButtonListener(),initLaunchButtonListener(),initLabAccessFormListener(),initAutoTabAccessCode()},ql.labActivityTracking={reset:function il(){document.querySelectorAll("ql-activity-tracking,ql-activity-tracking-ch").forEach(function(e){return e.reset()})}},ql.labAlert={alertMessage:function kl(e,t){var n=arguments.length<=1||t===undefined||t,o=document.getElementById("alert-snackbar");n&&o.setAttribute("error",!0),o.innerHTML=e,o.open()},alertHttpError:function ll(e){e.response.text().then(function(e){ql.labAlert.alertMessage(e)})}},ql.labAssessment=function(){var o=function o(e,n){$.get("/assessments/run_step.json?id="+e+"&step="+n).done(function(e){ql.labAssessment.update(e),int_no=parseInt(n)-1;var t=e.completion_only?"":"Check complete. Points earned: "+e.step_scores[int_no]+". Message: ";e.step_scores[int_no]==e.step_points[int_no]?(t+=""+(e.student_messages[int_no]||"Step is complete."),ql.labAlert.alertMessage(t,isError=!1)):(t+=""+(e.student_messages[int_no]||"It doesn't look like you've completed this step yet. Try again."),ql.labAlert.alertMessage(t))}).fail(function(){alert("Failed to update assessment")})};return{init:function t(){var e=new hallofmirrors.FocusTrap($(".js-lab-assessment-panel")[0]);$(".js-open-lab-assessment-panel").click(function(){$(".js-lab-assessment-panel").addClass("is-open"),e.trapFocus()}),$(".js-close-lab-assessment-panel").click(function(){$(".js-lab-assessment-panel").removeClass("is-open"),e.releaseFocus()}),$(".js-show-run-step-button").on("click",function(){var e=ql.labData.getLabInstanceId(),t=$(this).attr("step_no");e!==undefined&&ql.labData.isRunning()&&o(e,t)})},update:function n(e){if(void 0!==e&&"undefined"!=typeof e.total_score&&0!==e.total_score.length){var t="";for(t=e.completion_only?e.completed_steps+"/"+e.total_steps:e.total_score+"/"+e.perfect_score,$(".js-lab-assessment-total-score").html(t),i=1;i<=parseInt(e.total_steps);i++)e.completion_only?e.step_complete[i-1]?($(".js-assessment-step-score-"+i+" i:first-child").addClass("fa-check"),$(".js-assessment-step-score-"+i+" i:first-child").removeClass("fa-times")):($(".js-assessment-step-score-"+i+" i:first-child").addClass("fa-times"),$(".js-assessment-step-score-"+i+" i:first-child").removeClass("fa-check")):$(".js-assessment-step-score-"+i).html(e.step_scores[i-1])}},reset:function a(){var e=$(".js-lab-assessment-total-score").html();void 0!==e&&(e=e.replace(/.*\//,"\u2014/"),$(".js-lab-assessment-total-score").html(e),$('*[class^="js-assessment-step-score"]').html("\u2014"))}}}();var t="";initFakeAlertCloseListener=function(){$(".js-alert-close").click(function(){$(".js-alert").hide()})},initCopyCode=function(){$("pre code").each(function(t,e){$(e).after('<button class="button button--text button--small copy-button js-copy-button-'+t+'"><ql-icon>content_copy</ql-icon></button>');var n=document.getElementsByClassName("no-select")[0],o=new Clipboard(".js-copy-button-"+t,{target:function i(e){return n&&n.classList.remove("no-select"),e.previousElementSibling}});o.on("success",function(){n&&n.classList.add("no-select"),document.getSelection().removeAllRanges(),$(".js-copy-button-"+t).attr("title",trans.copied).tooltip("fixTitle").tooltip("show")}),o.on("error",function(){n&&n.classList.add("no-select"),document.getSelection().removeAllRanges();var e="";e=/iPhone|iPad/i.test(navigator.userAgent)?trans.no_support:/Mac/i.test(navigator.userAgent)?trans.mac_press:trans.windows_press,$(".js-copy-button-"+t).attr("title",e).tooltip("fixTitle").tooltip("show")}),$(".js-copy-button-"+t).mouseout(function(){$(this).tooltip("hide").tooltip("destroy")})})},initImageZoom=function(){$(".js-lab-content img").click(function(){var e=$(this).attr("src");$("body").append('<div class="lab-content__image-overlay js-zoomed-image"><img class="lab-content__image" src='+e+" /></div>").find(".js-zoomed-image").click(function(){$(".js-zoomed-image").remove()})})},initPrettyPrint=function(){$(function(){prettyPrint()})},initCodeTabs=function(){var e=Array.from(document.querySelectorAll("ql-code"));e.forEach(function(n){return n.addEventListener("tabchange",function(t){return e.filter(function(e){return e!==n}).forEach(function(e){return e.setLanguage(t.detail.newTab.language)})})})},initLabContent=function(){initFakeAlertCloseListener(),initCopyCode(),initImageZoom(),initPrettyPrint(),initCodeTabs()},ql.labControlPanel=function(){var r=undefined;return{init:function n(){function e(){document.getElementById("js-lab-are-you-sure-dialog").open()}(r=document.querySelector(".js-lab-control-panel")).addEventListener("clickedStartLab",function(){return requestStartLab()}),document.getElementById("js-are-you-sure-button").addEventListener("click",function(){ql.labRun.stopLab(),document.getElementById("js-lab-are-you-sure-dialog").close()}),r.addEventListener("clickedStopLab",e),$(".js-end-lab-button").on("clickedStopLab",e);var t=document.querySelector("#toggle-lab-control-panel");t&&t.addEventListener("click",function(){r.classList.toggle("toggled")})},update:function t(e){r.labControlButton=e.labControlButton,r.labTimer=e.labTimer,r.billingLimitRemainder=e.billingLimitRemainder,r.provisioning=e.provisioning,r.provisioningSecondsRemaining=e.provisioningSecondsRemaining,r.labDetails=e.labDetails,r.connectionFiles=e.connectionFiles},reset:function s(){r.labControlButton={running:!1,pending:!1},r.billingLimitRemainder=ql.labData.getLabBillingLimit(),r.provisioning=!1,r.provisioningSecondsRemaining=null,r.connectionFiles=[],r.labDetails=[];var e=!0,t=!(r.labTimer={ticking:!1,secondsRemaining:ql.labData.getLabDuration()}),n=undefined;try{for(var o,i=document.querySelectorAll(".js-end-lab-button-container")[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){o.value.classList.add("hidden")}}catch(a){t=!0,n=a}finally{try{!e&&i["return"]&&i["return"]()}finally{if(t)throw n}}this.hideV2Recaptcha()},setStarting:function e(){r.labControlButton={running:!1,pending:!0}},setStopping:function o(){r.labControlButton={running:!0,pending:!0}},setRunning:function i(){r.labControlButton={running:!0,pending:!1}},showV2Recaptcha:function a(){$("#recaptcha-v2-start-lab").removeClass("hidden")},hideV2Recaptcha:function l(){$("#recaptcha-v2-start-lab").addClass("hidden")},addRecaptchaErrorHandler:function c(){window.addEventListener("unhandledrejection",function(e){-1<e.reason.stack.indexOf("recaptcha")&&ql.labControlPanel.showV2Recaptcha()})}}}(),ql.labData=function(){var e=undefined,t=undefined,n=undefined,o=undefined;return{clearLabInstanceId:function i(){t=null},getLabInstanceId:function a(){return t},setLabInstanceId:function r(e){t=e},getAnalyticsPayload:function s(){return e.analyticsPayload},getLabBillingLimit:function l(){return Number(e.labBillingLimit)},getLabDuration:function c(){return Number(e.labDuration)},getFocusId:function u(){return e.focusId},getParent:function d(){return e.parent},getQlcampaign:function m(){return e.qlcampaign},isRecaptchaEnabled:function f(){return null!=e.recaptchaEnabled},getRecaptchaV3Token:function h(){return n},setRecaptchaV3Token:function p(e){n=e},getRecaptchaV2Token:function b(){return o},setRecaptchaV2Token:function v(e){o=e},isPaymentRequired:function y(){return null!=e.paymentRequired},isWarningGiven:function g(){return null!=e.warningGiven},isRunning:function _(){return null!=t},init:function q(){e=$(".js-lab-state").data(),t=e.labInstanceId}}}(),ql.editRows=function(){function e(){a=document.querySelectorAll(".js-edit-row"),r=document.querySelector(".js-edit-title"),s=[r].concat(_toConsumableArray(a)),a.forEach(function(e){return e.addEventListener("click",n)}),r.addEventListener("click",i),$errorFields=document.querySelectorAll(".has-error"),$errorFields.forEach(function(e){$row=e.closest(".js-edit-row"),o($row)}),$inputs=document.querySelectorAll(".js-lab-details input"),$inputs.forEach(function(e){e.addEventListener("keyup",t)})}function t(){$editRow=this.closest(".js-edit-row"),this.checkValidity()?$editRow.classList.remove("is-invalid"):$editRow.classList.add("is-invalid")}function n(){if(!this.classList.contains("is-selected")){i(),o(this);var e=this.querySelectorAll("input"),t=this.querySelectorAll("select"),n=this.querySelectorAll("textarea");n[0]?n[0].focus():t[0]?t[0].focus():e[0]&&e[0].focus()}}function o(e){var t=s.indexOf(e);s[t].classList.add("is-selected"),s[t].style.height=e.scrollHeight+24+"px",s[t-1]&&s[t-1].classList.add("is-bottom"),s[t+1]&&s[t+1].classList.add("is-top")}function i(){s.forEach(function(e){e.classList.remove("is-selected"),e.classList.remove("is-bottom"),e.classList.remove("is-top"),e.style.height="64px"})}var a="",r="",s=[];return{init:e}}(),ql.additionalResources=function(){function e(){$(document).on("nested:fieldAdded",t),$(document).on("nested:fieldRemoved",n)}function t(e){$editRow=e.target.closest(".js-edit-row"),$editRow.style.height=$editRow.scrollHeight+16+"px",ql.initMaterialInputs($editRow)}function n(e){$editRow=e.target.closest(".js-edit-row"),$editRow.style.height=$editRow.scrollHeight-o-16+"px"}var o=122;return{init:e}}(),ql.deploymentManager=function(){function e(){n=document.querySelector(".js-dm"),o=document.querySelector(".js-remove-dm-button"),i=document.querySelector(".js-remove-dm"),o.addEventListener("click",t)}function t(){n.href="",n.style.color="red",n.style.fontWeight="400",n.style.textDecoration="line-through",i.value=1,o.remove()}var n="",o="",i="";return{init:e}}(),ql.cloudFormation=function(){function e(){n=document.querySelector(".js-cf"),o=document.querySelector(".js-remove-cf-button"),i=document.querySelectorAll(".js-remove-cf"),o.addEventListener("click",t)}function t(){n.href="",n.style.color="red",n.style.fontWeight="400",n.style.textDecoration="line-through",i.forEach(function(e){return e.value=""}),o.remove()}var n="",o="",i="";return{init:e}}(),ql.studentPolicy=function(){function e(){n=document.querySelector(".js-sp"),o=document.querySelector(".js-remove-sp-button"),i=document.querySelectorAll(".js-remove-sp"),o.addEventListener("click",t)}function t(){n.href="",n.style.color="red",n.style.fontWeight="400",n.style.textDecoration="line-through",i.forEach(function(e){return e.value=""}),o.remove()}var n="",o="",i="";return{init:e}}(),ql.instruction=function(){function e(){$instructionContent=document.querySelector(".js-instruction-content"),$instructionHeader=document.querySelector(".js-instruction-header"),$instructionLoader=document.querySelector(".js-instruction-loader"),$instructionRefresh=document.querySelector(".js-instruction-refresh"),ql.subscribe("received-instruction-status",i),$instructionRefresh&&$instructionRefresh.addEventListener("click",t,!1)}function t(e){e.stopImmediatePropagation(),e.preventDefault(),$instructionContent.classList.add("is-faded"),$instructionLoader.classList.remove("is-hidden");var t=new Request(this.href,{method:"POST",credentials:"include",headers:new Headers({"X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').content})});fetch(t).then(status).then(json).then(function(e){return n(e.status_path)})["catch"](r)}function n(e){instructionPoller=new ql.Poller(e,1e3,o,r),instructionPoller.start()}function o(e){ql.publish("received-instruction-status",e)}function i(e){"completed"==e.state&&(instructionPoller.stop(),ql.getHtml(e.display_path).then(a)["catch"](r))}function a(e){$instructionContent.innerHTML=e,$instructionContent.classList.remove("is-faded"),$instructionContent.classList.remove("is-hidden"),$instructionHeader.classList.remove("has-error"),$instructionLoader.classList.add("is-hidden")}function r(e){var t="Response not a JSON";"string"==typeof e?e.json().then(function(e){t=e.errors}):t=e.statusText,htmlSafeMessage=$("<div>").text(t).html(),$instructionContent.innerHTML="<div class='lab__instructions__error'>\n        <i class='material-icons'>error_outline</i>\n        <p>"+htmlSafeMessage+"</p>\n      </div>",$instructionContent.classList.remove("is-faded"),$instructionContent.classList.remove("is-hidden"),$instructionHeader.classList.add("has-error"),$instructionLoader.classList.add("is-hidden")}return $instructionCard="",$instructionContent="",$instructionHeader="",$instructionLoader="",$instructionRefresh="",instructionPoller={},{init:e,poll:n}}(),ql.downloadLab=function(){function e(){function e(){t.setAttribute("disabled","disabled"),t.querySelector("i").innerText="checkmark"}var t=document.getElementById("file_download-header");null!==t&&t.addEventListener("click",e)}return{init:e}}(),ql.publishLab=function(){function e(){$publishButton=document.querySelector(".js-publish-button"),$toast=document.querySelector(".js-toast"),$toastMessage=document.querySelector(".js-toast-message"),$toastLoader=$toast.querySelector(".mdl-js-progress"),ql.subscribe("received-publish-status",i),$publishButton.addEventListener("click",t)}function t(e){e.preventDefault();var t=new Request(this.href,{method:"POST",credentials:"include",headers:new Headers({"X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').content})});fetch(t).then(status).then(json).then(function(e){return n(e.status_path)})["catch"](console.error)}function n(e){publishPoller=new ql.Poller(e,500,o),publishPoller.start()}function o(e){ql.publish("received-publish-status",e)}function i(e){"done"==e.status||"error"==e.status?(publishPoller.stop(),$toastLoader.classList.remove("is-visible"),$toastMessage.innerHTML=e.html):$toastLoader.classList.contains("is-visible")||($toastLoader.classList.add("is-visible"),$toastMessage.innerHTML=e.html),"error"===e.status?(ql.showFlash("warn",e.html),$toast.classList.remove("is-visible")):$toast.classList.add("is-visible")}return $publishButton="",$toast="",$toastMessage="",$toastLoader="",publishPoller={},{init:e,poll:n}}(),ql.labLocale=function(){function e(){$newLocaleButton=document.querySelector(".js-new-locale"),$dialog=document.querySelector(".js-dialog"),$localeDialogBody=$dialog.querySelector(".js-new-lab-locale"),localeDialog=new ql.MaterialDialog($dialog),$newLocaleButton.addEventListener("click",t)}function t(e){e.preventDefault(),ql.getHtml(this.href).then(n).then(o)["catch"](console.error)}function n(e){$localeDialogBody.innerHTML=e,ql.initMaterialInputs($localeDialogBody),localeDialog.open()}function o(){$(document).on("ajax:success","form",function(e,t,n,o){$(document).off("ajax:success"),localeDialog.close(),window.location.replace(o.responseJSON.url)}).on("ajax:error","form",function(e,t,n,o){console.error(o)})}return $dialog="",$newLocaleButton="",$localeDialogBody="",localeDialog={},{init:e}}(),ql.tagSelect=function(){function e(){n=document.querySelector(".js-chosen-tags").closest(".js-edit-row"),$(".js-chosen-tags").chosen().change(t)}function t(){$chosenContainers=n.querySelectorAll(".chosen-container");var t=293;$chosenContainers.forEach(function(e){t+=e.offsetHeight}),n.style.height=t+"px"}var n=undefined;return{init:e}}(),ql.permissionsSelect=function(){function e(){s=document.querySelector(".js-permissions-advanced-link"),r=document.querySelector(".js-chosen-permissions"),(a=document.querySelector(".js-permissions-input")).addEventListener("change",n),s.addEventListener("click",o),$(".js-chosen-permissions").chosen().change(t)}function t(){var e=[].concat(_toConsumableArray(this.selectedOptions)).map(function(e){return e.value}).join("\r\n");a.value=e,i()}function n(){this.classList.contains("is-visible")&&([].concat(_toConsumableArray(r.querySelectorAll("option"))).forEach(function(e){return e.selected=!1}),this.value.split("\n").forEach(function(e){var t=r.querySelector("[value='"+e+"']");t&&(t.selected=!0)}),$(".js-chosen-permissions").trigger("chosen:updated"));i()}function o(){a.classList.toggle("is-visible"),$chosen=document.querySelector(".js-permissions .chosen-container"),$chosen.classList.toggle("is-hidden"),$editRow=this.closest(".js-edit-row"),$editRow.classList.toggle("is-advanced"),newLabel=this.dataset.label,oldLabel=this.innerText,this.setAttribute("data-label",oldLabel),this.innerText=newLabel,i()}function i(){$chosen=document.querySelector(".js-permissions .chosen-container"),h=$chosen.offsetHeight,$editRow=$chosen.closest(".js-edit-row"),$editRow.style.height=h+114+"px"}var a="",r="",s="";return{init:e}}(),ql.disableLab=function(){function e(){$disableButton=document.querySelector(".js-disable-lab"),$disableIcon=$disableButton.querySelector("ql-icon"),$disableButton.addEventListener("click",t,!1),$disableNotice=document.querySelector(".js-disable-notice"),ql.subscribe("labUpdated",o)}function t(e){e.preventDefault(),e.stopImmediatePropagation(),n(this.href)}function n(e){fetch(e,{method:"PATCH",credentials:"include",headers:new Headers({"X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').content,Accept:"application/json","Content-Type":"application/json"})}).then(status).then(json).then(function(e){return ql.publish("labUpdated",e)})["catch"](function(e){return console.log(e)})}function o(e){var t=e.disabled_for_catalogs_at?"disable":"enable",n=e.disabled_for_catalogs_at?"enable":"disable",o=e.disabled_for_catalogs_at?"check_box":"check_box_outline_blank",i=e.disabled_for_catalogs_at?"Enable lab":"Disable lab",a=$disableButton.href.replace(t,n);$disableButton.href=a,$disableIcon?$disableIcon.innerHTML=o:$disableButton.innerHTML=i,e.disabled_for_catalogs_at?$("#modal_disable").modal("show"):$disableNotice.remove()}return $disableButton={},$disableIcon={},$disableNotice={},{init:e}}(),ql.labIndexView=function(){function e(){(n=[].concat(_toConsumableArray(document.querySelectorAll(".js-lab-row")))).length&&(n[o].focus(),window.addEventListener("keyup",t))}function t(e){"ArrowDown"===e.key?n[o+1]&&n[++o].focus():"ArrowUp"===e.key&&n[o-1]&&n[--o].focus()}var n=[],o=0;return{init:e}}(),ql.labInlineInstructionComponents=function(){var e=["ql-activity-tracking","ql-activity-tracking-ch","ql-multiple-choice-probe","ql-multiple-select-probe","ql-true-false-probe"].join(", ");return{updateLabInstanceId:function t(){$(e).attr("labInstanceId",ql.labData.getLabInstanceId())}}}(),ql.labLayout={setTerminalLayout:function Ap(){var e=document.getElementById("terminal-drawer"),t=document.getElementById("control-panel-drawer"),n=document.getElementById("outline-drawer"),o=document.querySelector(".js-lab-control-panel"),i=document.getElementById("control-panel-menu"),a=document.getElementById("control-panel-target"),r=!0,s=!1,l=undefined;try{for(var c,u=document.querySelectorAll(".js-end-lab-button-container")[Symbol.iterator]();!(r=(c=u.next()).done);r=!0)c.value.classList.remove("hidden")}catch(d){s=!0,l=d}finally{try{!r&&u["return"]&&u["return"]()}finally{if(s)throw l}}i.children[0]!==o&&(i.appendChild(o),a.style.display="block",i.open()),t&&(t.open=!1),n&&(n.open=!1),e&&(e.open=!0)},reset:function Bp(){var e=document.getElementById("terminal-drawer"),t=document.getElementById("control-panel-drawer"),n=document.getElementById("outline-drawer"),o=document.querySelector(".js-lab-control-panel"),i=document.getElementById("control-panel-target");t.appendChild(o),i.style.display="none",
e&&(e.open=!1),t&&(t.open=!0),n&&(n.open=!0),this.resizeLayout()},resizeLayout:function Cp(){if(ql.cloudTerminal.isTerminalActive()){var e=document.getElementById("terminal-drawer");return e.open=!1,void(e.open=!0)}var t=document.getElementById("outline-drawer"),n=document.querySelector(".lab-content__outline"),o=document.querySelector(".lab-outline-place-holder"),i=document.getElementById("control-panel-drawer"),a=document.querySelector(".js-lab-control-panel"),r=document.getElementById("lab-instructions");window.innerWidth<960?(a.classList.add("ql-lab-control-panel__in-content-drawer"),r.prepend(a),t&&(t.open=!1),i.open=!1,n&&(n.classList.add("ql-lab-outline__in-content-drawer"),o.prepend(n))):(a.classList.remove("ql-lab-control-panel__in-content-drawer"),i.appendChild(a),t&&(t.open=!0),i.open=!0,n&&(n.classList.remove("ql-lab-outline__in-content-drawer"),t.appendChild(n)))},enableResizeLayout:function Dp(){this.resizeLayout(),window.addEventListener("resize",this.resizeLayout)}},ql.labOutline={links:function(){function e(){$container=document.querySelector(".js-lab-wrapper"),i=document.querySelector(".js-lab-content"),r=i.querySelectorAll("h2:not(ql-expandable-infobox > h2)"),a=document.querySelector(".js-lab-content-outline"),(s=a.querySelectorAll("a")).forEach(function(e){return e.addEventListener("click",t)}),$container.addEventListener("scroll",o)}function t(e){e.preventDefault(),ql.track("clicked_lab_outline",{label:e.target.innerText});var t=e.target.getAttribute("href"),n=i.querySelector(t);n&&$($container).animate({scrollTop:n.offsetTop-l},500,function(){e.target.blur(),o()})}function o(){requestAnimationFrame(function(){var t=$container.scrollTop+c,e=[].concat(_toConsumableArray(r)).filter(function(e){return e.offsetTop<=t});n(e.length?e.pop():null)})}function n(e){if(s.forEach(function(e){return e.classList.remove("is-active")}),s.forEach(function(e){return e.removeAttribute("aria-current")}),null!=e){var t=a.querySelector("a[href='#"+e.id+"']");t.classList.add("is-active"),t.setAttribute("aria-current","step")}}var i=undefined,a=undefined,r=undefined,s=undefined,l=24,c=160;return{init:e}}()};var initRateItListener=function initRateItListener(){$(".js-rateit").bind("keydown",onSliderKeydown.bind(this)),$(".js-rateit").bind("rated",function(e,t){setRating(t),$("#submit").data("disabled")||$("#submit").prop("disabled",!1)}),$("#rate-lab-btn").on("click",function(){return openLabReview()})},openLabReview=function openLabReview(){document.getElementById("lab-review-dialog").open()},initFormSubmitHandler=function initFormSubmitHandler(){$("#submit").on("click",function(){return $(".js-lab-review-form").submit()})},initReviewSubmitListener=function initReviewSubmitListener(){$(".js-lab-review-form").on("ajax:success",function(e,t,n,o){alertLabReviewSuccess(o)}).on("ajax:error",function(e,t){alertLabReviewError(t.responseText)})},alertLabReviewSuccess=function alertLabReviewSuccess(){document.getElementById("lab-review-dialog").close();var e=document.getElementById("alert-snackbar");e.innerHTML=trans.thanks_review,e.open()},alertLabReviewError=function alertLabReviewError(e){document.getElementById("lab-review-dialog").close();var t=document.getElementById("alert-snackbar");t.setAttribute("error",!0),t.innerHTML=JSON.parse(e).message,t.open()},setRating=function setRating(e){$(".js-rating-input").val(e-3);var t=document.getElementById("lab-review-rateit");t.setAttribute("aria-valuenow",e),t.setAttribute("aria-valuetext",transSlider["star_amount_"+e])},moveSliderTo=function moveSliderTo(e){e=Math.min(Math.max(e,1),$("#lab-review-rateit").rateit("max"));$("#lab-review-rateit").rateit("value",e),$("#lab-review-rateit").trigger("rated",e)},onSliderKeydown=function onSliderKeydown(e){var t=$("#lab-review-rateit").rateit("value");switch(e.key){case"ArrowLeft":case"ArrowDown":this.moveSliderTo(t-1);break;case"ArrowRight":case"ArrowUp":this.moveSliderTo(t+1)}},initLabReviewModal=function initLabReviewModal(){initRateItListener(),initReviewSubmitListener(),initFormSubmitHandler()},transSlider={},initLabReviewTranslations=function initLabReviewTranslations(e){transSlider=e};ql.labRun=function(){function e(){o=new hallofmirrors.lab.LabInstancePoller({labRunnerId:ql.labData.getFocusId(),labContainerType:ql.labData.getParent(),successCallback:function t(e){e.isExpired?ql.labRun.stopLab():(ql.labData.setLabInstanceId(e.labInstanceId),ql.labAssessment.update(e.assessmentInfo),ql.game.updateLabLeaderboard(e.gameLeaderboard),ql.labInlineInstructionComponents.updateLabInstanceId(),ql.labControlPanel.update(e),ql.instructionVariables.update(e.resourceData),ql.cloudTerminal.update(e.terminalUrl),e.terminalUrl&&ql.labLayout.setTerminalLayout())},errorCallback:function n(e){console.error("Lab poll error: ",e)}})}var o=undefined;return{init:function t(){ql.labControlPanel.init(),ql.labLayout.enableResizeLayout(),e(),ql.labData.isRunning()&&o.start()},startLab:function i(e){var t=e.accessSuccess;if(!ql.labData.isPaymentRequired()&&!ql.labData.isWarningGiven()||t){ql.labControlPanel.setStarting();var n=function n(){return ql.labData.isRecaptchaEnabled()?executeRecaptchaForStartLabAsync().then(function(e){return ql.labData.setRecaptchaV3Token(e)}):Promise.resolve()};n().then(function(){return ql.labXhr.startLab()}).then(function(e){e.message&&hallofmirrors.snackbarService.alert(e.message),ql.track("lab_started",ql.labData.getAnalyticsPayload()),o.start(),ql.labControlPanel.hideV2Recaptcha(),ql.labData.setRecaptchaV2Token(undefined),ql.labData.setRecaptchaV3Token(undefined)})["catch"](function(e){ql.labControlPanel.reset(),ql.labAlert.alertHttpError(e)})}else $("#lab-access-modal").modal("show")},stopLab:function n(){ql.labControlPanel.setStopping(),ql.track("clicked_end_lab_button",ql.labData.getAnalyticsPayload()),ql.labXhr.stopLab().then(function(e){var t=e.runtime_error,n=e.resource_limit_violation;ql.labData.clearLabInstanceId(),o.stop(),ql.labControlPanel.reset(),ql.labAssessment.reset(),ql.labActivityTracking.reset(),ql.instructionVariables.reset(),ql.cloudTerminal.reset(),ql.labLayout.reset(),t?ql.labAlert.alertMessage(t):n?ql.labAlert.alertMessage(n):document.getElementById("lab-review-dialog").open()})["catch"](function(e){ql.labAlert.alertHttpError(e),ql.labControlPanel.setRunning()})}}}(),ql.labXhr={startLab:function kr(){return hallofmirrors.lab.labHttpService.startLab({labRunnerId:ql.labData.getFocusId(),labContainerType:ql.labData.getParent(),qlcampaign:ql.labData.getQlcampaign(),recaptchaV3Token:ql.labData.getRecaptchaV3Token(),recaptchaV2Token:ql.labData.getRecaptchaV2Token()})},stopLab:function lr(){var e=ql.labData.getLabInstanceId();return e?hallofmirrors.lab.labHttpService.endLab({labInstanceId:e}):Promise.resolve({runtime_error:null,resource_limit_violation:null})}},ql.learningPlanEdit=function(){function e(){$(".js-sortable").sortable({placeholder:"sortable-placeholder",tolerance:"pointer",update:function c(){var e=Array.from(document.querySelectorAll(".learnable-position-field")),t=!0,n=!1,o=undefined;try{for(var i,a=e.entries()[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var r=_slicedToArray(i.value,2),s=r[0];r[1].value=s}}catch(l){n=!0,o=l}finally{try{!t&&a["return"]&&a["return"]()}finally{if(n)throw o}}}});var e=document.querySelectorAll("ql-activity-card ql-toggle-button"),t=!0,n=!1,o=undefined;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0)button=i.value,button.addEventListener("click",s)}catch(r){n=!0,o=r}finally{try{!t&&a["return"]&&a["return"]()}finally{if(n)throw o}}}function s(){var e=this.dataset.itemid,t=document.querySelector(".destroy-"+e+"-field");t&&("false"===t.value?(t.value="true",this.parentElement.disabled=!0):(t.value="false",this.parentElement.disabled=!1))}function t(e){var t,n;e.files&&e.files[0]&&(t=new FileReader,n=document.querySelector("ql-learning-plan-card"),t.onload=function(e){n.setAttribute("imagesrc",e.target.result)},t.readAsDataURL(e.files[0]))}return{init:e,update_image_preview:t}}(),ql.learningTree={info:function(){function e(){var t=document.querySelector("#drawer-container"),n=document.querySelector("#learning-tree-info-drawer");n.addEventListener("toggle",function(e){e.target===n&&(e.detail.on?t.classList.add("info-drawer-opened"):t.classList.remove("info-drawer-opened"))});var e=!0,o=!1,i=undefined;try{for(var a,r=document.querySelectorAll(".js-close-learning-tree-info")[Symbol.iterator]();!(e=(a=r.next()).done);e=!0){a.value.addEventListener("click",function(){n.hide()})}}catch(s){o=!0,i=s}finally{try{!e&&r["return"]&&r["return"]()}finally{if(o)throw i}}}return{init:e}}()},ql.list=function(){function e(){document.querySelectorAll(".js-list-item").forEach(function(e){$expandToggle=e.querySelector(".js-list-item-expand"),$expandToggle.addEventListener("click",t,!1)})}function t(){$listItem=this.closest(".js-list-item"),$listItemDetails=$listItem.querySelector(".js-list-item-details"),$listItem.classList.toggle("is-expanded");var e=this.offsetHeight+$listItemDetails.offsetHeight;$listItem.style.height=e+"px"}return{init:e}}(),ql.MaterialDialog=function(e,t){this.dialog=e,this.dismissers=$(this.dialog).find("[data-dismiss]"),this.isOpen=t||!1,this.listen(),this.upgrade(),this.render()},ql.MaterialDialog.prototype.upgrade=function(){$(this.dialog).addClass("is-upgraded")},ql.MaterialDialog.prototype.listen=function(){for(var e=0;e<this.dismissers.length;e++)this.dismissers[e].addEventListener("click",this.close.bind(this))},ql.MaterialDialog.prototype.close=function(){this.isOpen=!1,this.render()},ql.MaterialDialog.prototype.open=function(){this.isOpen=!0,this.render()},ql.MaterialDialog.prototype.render=function(){this.isOpen?$(this.dialog).addClass("is-open"):$(this.dialog).removeClass("is-open")},ql.MaterialInput=function(e){this.input=e,this.wrapper=this.input.parentElement.parentElement,this.isFilled=!!this.input.value,this.isValid=!0,this.listen(),this.upgrade()},ql.MaterialInput.prototype.listen=function(){this.input.addEventListener("input",this.setAndRender.bind(this)),this.input.addEventListener("blur",this.setAndRender.bind(this))},ql.MaterialInput.prototype.upgrade=function(){$(this.input).addClass("is-upgraded")},ql.MaterialInput.prototype.setAndRender=function(){this.setAttributes(),this.isFilled?$(this.input).addClass("is-filled"):$(this.input).removeClass("is-filled"),this.isValid?$(this.wrapper).removeClass("has-error"):$(this.wrapper).addClass("has-error")},ql.MaterialInput.prototype.setAttributes=function(){this.setIsFilled(),this.setIsValid()},ql.MaterialInput.prototype.setIsFilled=function(){this.isFilled=!!this.input.value},ql.MaterialInput.prototype.setIsValid=function(){this.isValid=this.input.validity.valid},ql.initMaterialInputs=function(e){if((e=e||[]).length)var t=e.find(".md-input__input");else t=document.getElementsByClassName("md-input__input");for(var n=0;n<t.length;n++)$(t[n]).hasClass("is-upgraded")||new ql.MaterialInput(t[n])},ql.modals=function(){function e(){$(".modal[data-show]").modal("show"),$(".modal[data-modal-shown-path]").on("show.bs.modal",function(){$.get(this.dataset.modalShownPath)}).modal("show"),document.addEventListener("openModal",t)}function t(e){if(modal=document.getElementById(e.detail.modal),!modal)throw new Error("Modal with id "+e.detail.modal+" not found.");"function"==typeof modal.open?modal.open():$(modal).modal("show")}return{init:e}}(),ql.navPanel=function(){function e(){n=document.querySelector(".js-nav-panel"),document.querySelectorAll(".js-nav-toggle").forEach(function(e){return e.addEventListener("click",t)})}function t(e){e.preventDefault(),n.classList.toggle("is-open"),ql.track("Side navigation toggled",{category:"Navigation"})}var n=undefined;return{init:e}}(),ql.navigation=function(){function e(){document.querySelectorAll(".js-navigation-button").forEach(function(e){e.addEventListener("click",t,!1)})}function t(){ql.track("Navigation link clicked",{category:"Navigation",label:this.title})}undefined;return{init:e}}(),ql.initNewLabWindowListener=function(){$(window).resize(function(){ql.setHorizontal()})},ql.setHorizontal=function(){$(window).width()<600?($(".md-input").removeClass("md-input--horizontal"),$(".js-permissions-select").removeClass("permissions-select__container--horizontal"),$(".js-labs-resources").removeClass("labs__resources--horizontal")):($(".md-input").addClass("md-input--horizontal"),$(".js-student-resources .md-input").removeClass("md-input--horizontal"),$(".js-permissions-select").addClass("permissions-select__container--horizontal"),$(".js-labs-resources").addClass("labs__resources--horizontal"))},ql.initNewStudentResourceListener=function(){$(document).on("nested:fieldAdded",function(e){for(var t=e.field.find(".md-input__input"),n=0;n<t.length;n++)new ql.MaterialInput(t[n])})},ql.initInstructionRemovedListener=function(){$(document).on("nested:fieldRemoved",function(e){e.field.next(".js-add-instruction").click()})};var initNewLab=function initNewLab(){ql.setHorizontal(),ql.initNewLabWindowListener(),ql.initNewStudentResourceListener(),ql.initInstructionRemovedListener()};ql.initNewLabLocale=function(){ql.initNewLabLocaleButtonListener(),ql.initNewLabLocaleSubmitListener()},ql.initNewLabLocaleButtonListener=function(){$(".js-new-lab-locale-button").on("ajax:success",function(e,t,n,o){$(".js-new-lab-locale").html(o.responseText),ql.initMaterialInputs($(".js-new-lab-locale")),ql.newLabLocaleDialog=new ql.MaterialDialog($(".js-dialog"),!0)})},ql.initNewLabLocaleSubmitListener=function(){$(document).on("ajax:success","form",function(e,t,n,o){ql.newLabLocaleDialog.close(),$(".js-lab-locales-table").find(".flex-table__row:nth-child(1)").after(o.responseText),$(".js-lab-locales-table").find(".flex-table__row:nth-child(2)").addClass("is-new")}).on("ajax:error","form",function(){console.log("aww")})},ql.inviteMembers=function(){function e(){$toast=document.querySelector(".js-toast"),$toastMessage=document.querySelector(".js-toast-message"),$toastLoader=$toast.querySelector(".mdl-js-progress"),ql.subscribe("received-operation-status",o)}function t(e){poller=new ql.Poller(e,1e4,n),poller.start()}function n(e){ql.publish("received-operation-status",e)}function o(e){if("finished"===e.status)if(poller.stop(),$toastLoader.classList.remove("is-visible"),e.succeeded)window.location.reload();else{var t=JSON.parse(e.result);ql.showFlash("warn",t.message),$toast.classList.remove("is-visible")}else $toastLoader.classList.contains("is-visible")||$toastLoader.classList.add("is-visible")}return $toast="",$toastMessage="",$toastLoader="",poller={},{init:e,poll:t}}(),ql.customFilter=function(){function e(){$enableCheckbox=document.querySelector(".js-enable-custom-filter"),$enableCheckbox.addEventListener("click",t)}function t(){enable=!0===$enableCheckbox.checked,$.post(window.location.pathname+"/toggle_enable",{enable:enable})}return $enableCheckbox="",{init:e}}(),ql.organizationForm=function(){function e(){var n,e=document.getElementById("organization_name"),o=document.getElementById("organization_slug");e&&o&&(n=!1,e.addEventListener("change",function(e){if(""===o.value||!n){var t=e.currentTarget.value;o.value=t.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"")}}),o.addEventListener("change",function(){n=!0}))}return{init:e}}(),ql.organizationSubscriptions=function(){function a(e){var t=document.getElementById("card_element_errors"),n=document.getElementById("subscribe_button");e.error?t.textContent=e.error.message:t.textContent="",n.disabled=!1}function t(){localStorage.removeItem("latestInvoiceId"),localStorage.removeItem("latestInvoicePaymentIntentStatus")}function o(e){var t=e.subscription,n=e.invoice,o=e.paymentMethodId,i=e.isRetry;if(t&&"active"===t.status)return{subscription:t,paymentMethodId:o};var a=n?n.payment_intent:t.latest_invoice.payment_intent;return"requires_action"===a.status||!0===i&&"requires_payment_method"===a.status?u.confirmCardPayment(a.client_secret,{payment_method:o}).then(function(e){if(e.error)throw e;if("succeeded"===e.paymentIntent.status)return{subscription:t,invoice:n,paymentMethodId:o}}):{subscription:t,paymentMethodId:o}}function i(e){var t=e.subscription,n=e.paymentMethodId;if("active"===t.status)return{subscription:t,paymentMethodId:n};if("requires_payment_method"===t.latest_invoice.payment_intent.status)throw localStorage.setItem("latestInvoiceId",t.latest_invoice.id),localStorage.setItem("latestInvoicePaymentIntentStatus",t.latest_invoice.payment_intent.status),{error:{message:"Your card was declined."}};return{subscription:t,paymentMethodId:n}}function r(){var e=document.getElementById("subscribe_button").dataset.successMessage;t(),hallofmirrors.snackbarService.alert(e)}function s(t,e){var n=document.getElementById("subscribe_button").dataset.subscriptionPath;return fetch(n,{method:"post",credentials:"include",headers:{Accept:"application/json","Content-type":"application/json","X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({subscription:{payment_method_id:t,quantity:e}})}).then(function(e){return e.json()}).then(function(e){if(e.error)throw e;return e}).then(function(e){return{paymentMethodId:t,subscription:e}}).then(o).then(i).then(r)["catch"](function(e){a(e)})}function l(t,e){var n=document.getElementById("subscribe_button").dataset.retryPath;return fetch(n,{method:"post",credentials:"include",headers:{Accept:"application/json","Content-type":"application/json","X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({invoice:{payment_method_id:t,invoice_id:e}})}).then(function(e){return e.json()}).then(function(e){if(e.error)throw e;return e}).then(function(e){return{invoice:e,paymentMethodId:t,isRetry:!0}}).then(o).then(r)["catch"](function(e){a(e)})}function c(e){var t=e.card,n=e.isPaymentRetry,o=e.invoiceId,i=$("#payment_seat_quantity").val().trim();return u.createPaymentMethod({type:"card",card:t}).then(function(e){e.error?a(e):n?l(e.paymentMethod.id,o):s(e.paymentMethod.id,i)})}function e(e){var n=(u=Stripe(e)).elements().create("card");n.mount("#card_element"),n.on("change",function(e){a(e)}),document.querySelector("#payment_form").addEventListener("submit",function(e){if(e.preventDefault(),"requires_payment_method"===localStorage.getItem("latestInvoicePaymentIntentStatus")){var t=localStorage.getItem("latestInvoiceId");c({card:n,isPaymentRetry:!0,invoiceId:t})}else c({card:n})})}var u=undefined;return{init:e}}(),ql.pagination=function(){function e(){t(),n()}function t(){i=document.querySelectorAll(".js-pagination select")}function n(){i.forEach(function(e){e.addEventListener("change",o)})}function o(e){if(e.preventDefault(),this.value&&"URLSearchParams"in window){var t=new URLSearchParams(window.location.search);t.set(this.name,this.value),window.location.search=t.toString()}}var i="";return{init:e}}();var initPaymentsPage=function initPaymentsPage(){$(".js-purchase-option").first().prop("checked",!0)},initRadioButtonListener=function initRadioButtonListener(){$(".js-purchase-option").change(function(){$(".js-purchase-option").siblings(".js-purchase-option-details").removeClass("is-selected"),$(this).siblings(".js-purchase-option-details").addClass("is-selected"),updateTotal(),$(this).hasClass("js-other-credit")||$(".js-other-credit").prop("disabled",!0)})},initOtherRadioButtonListener=function initOtherRadioButtonListener(){$(".js-other-option").change(function(){$(".js-other-credit").prop("disabled",!1).focus()})},initOtherInputListener=function initOtherInputListener(){$(".js-other-credit").on("keyup mouseup change",function(){$(".js-other-option").val($(this).val()),updateTotal()})},initAddPromoCodeButtonListener=function initAddPromoCodeButtonListener(){$(".js-add-promo-code-button").click(function(e){e.preventDefault();var t=$(".js-purchase-option:checked"),n=t.val().trim(),o=t.data("product-code"),i=$(".js-promo-code").val().trim(),a=$(".js-payments-paths").data("validate-promo-code-path");if(null==i||") && (quantity == null || quantity == "==i)return!1;$.get(a,{uuid:i,credits:n,product_code:o},null,"html").success(function(e){$(".js-payment-details").html(e),$("#payment_details_modal").modal("show"),initRedeemPromoCodeButtonListener(),updateTotal()})})},initRedeemPromoCodeButtonListener=function initRedeemPromoCodeButtonListener(){$("#redeem_now").click(function(){redeemNowUrl=$(".js-payments-paths").data("redeem-now-path"),promoCode=$(".js-promo-code").val().trim(),$.post(redeemNowUrl,{uuid:promoCode}).fail(function(e){alert("Redeem call failed: "+e.responseText)}).done(function(e){window.location.href=e})})},updateTotal=function updateTotal(){var e=$(".js-purchase-option:checked"),t=e.val().trim(),n=e.data("product-code"),o=$(".js-promo-code").val().trim(),i=e.data("course-id"),a=$(".js-payments-paths").data("calculate-total-path");$.get(a,{quantity:t,product_code:n,promo_code:o,course_id:i},null,"json").success(function(e){e.full_price.subtotal?($(".js-payment-sub-total").html(e.full_price.subtotal),$(".js-payment-tax").html(e.full_price.tax),$(".js-payment-total").html(e.full_price.total)):$(".js-payment-total").html(e.price),$(".js-payment-total").data("price_in_cents",e.price_in_cents)})},initStripeButton=function initStripeButton(){if($(".js-stripe-button").length){var s=$(".js-stripe-button").data("currency"),e="usd"===s||"cny"===s,l=StripeCheckout.configure({key:$(".js-stripe-button").data("key"),currency:$(".js-stripe-button").data("currency"),alipay:e,locale:"auto",token:function c(e){var t=$(".js-purchase-option:checked"),n=t.val().trim(),o=t.data("product-code"),i=$(".js-promo-code").val().trim(),a=$(".js-stripe-button").data("process-path"),r=t.data("courseId");$.post(a,{stripeEmail:e.email,stripeToken:e.id,quantity:n,promo_code:i,product_code:o,course_id:r,referrer:$(".js-stripe-button").data("referrer").trim()}).fail(function(e){console.log("Stripe call failed: "+e)}).done(function(e){window.location.href=e})}});$(".js-stripe-button").on("click",function(e){e.preventDefault();var t=$(".js-purchase-option:checked"),n=t.val().trim(),o=t.data("product-code"),i=$(".js-promo-code").val().trim(),a=t.data("course-id"),r=$(".js-payments-paths").data("validate-path");$.post(r,{quantity:n,promo_code:i,product_code:o,course_id:a}).fail(function(e){$(".js-payment-details").html(e.responseText),$("#payment_details_modal").modal("show"),initRedeemPromoCodeButtonListener()}).done(function(){var e=$(".js-payments-paths").data("calculate-total-path");$.get(e,{quantity:n,promo_code:i,product_code:o,course_id:a},null,"json").success(function(e){console.log(spluralize(n,o)),"undefined"!=typeof analytics&&(analytics.track("payment",{product_code:o,promo_code:i,currency:s,quantity:n,amount:e.price_in_cents}),console.log("payment event sent")),l.open({description:e.title,amount:e.price_in_cents})})})}),$(window).on("popstate",function(){l.close()})}var n=$(".js-change-credit-card");if(n.length){var t=StripeCheckout.configure({key:n.data("key"),locale:"auto",token:function c(e){var t=n.data("process-path");$.post(t,{stripeToken:e.id,referrer:n.data("referrer").trim()}).fail(function(e){console.log("Stripe call failed: "+e)}).done(function(e){window.location.href=e})}});n.on("click",function(e){e.preventDefault(),t.open({description:"Update Card Details",panelLabel:"Update Card Details"}),$(window).on("popstate",function(){t.close()})})}},spluralize=function spluralize(e,t){return 1==e?e+" "+t:e+" "+t+"s"},initPayments=function initPayments(){initPaymentsPage(),updateTotal(),initRadioButtonListener(),initOtherRadioButtonListener(),initOtherInputListener(),initAddPromoCodeButtonListener(),initStripeButton()};ql.Permissions=function(e){var t=this;this.button=e,this.menu=new ql.PermissionsMenu($('ul[for="'+this.button.attr("id")+'"]')),this.overlay=$('aside[for="'+this.button.attr("id")+'"]'),this.permissions=this.button.data("permissions"),this.menu.setPermissions=function(e){t.setPermissions(e)},this.button.click(function(){t.menu.isVisible=!0,t.render()}),this.overlay.click(function(){t.menu.isVisible=!1,t.render()}),this.render()},ql.Permissions.prototype.setPermissions=function(e){var t=this.permissions.indexOf(e);0<=t?this.permissions.splice(t,1):this.permissions.push(e),$(".js-permissions-input").val(this.permissions.join("\r\n")),this.render()},ql.Permissions.prototype.render=function(){for(var e=[],t=0;t<this.permissions.length;t++)e.push("<span>"+this.permissions[t]+"</span>");this.button.find("#permissions-display").html(e),this.menu.render()},ql.PermissionsMenu=function(e){var t=this;this.element=e,this.isVisible=!1,this.setPermissions="",this.categories=[];for(var n=this.element.children("li"),o=0;o<n.length;o++)this.categories.push(new ql.PermissionsMenuCategory($(n[o]))),this.categories[o].setPermissions=function(e){t.setPermissions(e)}},ql.PermissionsMenu.prototype.render=function(){this.isVisible?this.element.addClass("is-visible"):this.element.removeClass("is-visible");for(var e=0;e<this.categories.length;e++)this.categories[e].render()},ql.PermissionsMenuCategory=function(e){var t=this;this.element=e,this.isSelected=!1,this.setPermissions="",this.items=[];for(var n=this.element.find("[data-permission]"),o=0;o<n.length;o++)this.items.push(new ql.PermissionsMenuItem($(n[o]))),this.items[o].setPermissions=function(e){t.setPermissions(e)}},ql.PermissionsMenuCategory.prototype.setSelected=function(){this.isSelected=!1;for(var e=0;e<this.items.length;e++)this.items[e].isSelected&&(this.isSelected=!0)},ql.PermissionsMenuCategory.prototype.render=function(){this.setSelected(),this.isSelected?this.element.addClass("is-selected"):this.element.removeClass("is-selected");for(var e=0;e<this.items.length;e++)this.items[e].render()},ql.PermissionsMenuItem=function(e){var t=this;this.element=e,this.isSelected=this.element[0].hasAttribute("data-selected"),this.permission=e.data("permission"),this.setPermissions="",this.element.click(function(){t.isSelected=!t.isSelected,t.setPermissions(t.permission)})},ql.PermissionsMenuItem.prototype.render=function(){this.isSelected?this.element.addClass("is-selected"):this.element.removeClass("is-selected")};var initPermissionsSelect=function initPermissionsSelect(){ql.permissions=new ql.Permissions($(".js-permissions"))};ql.initPublishModal=function(){$("#publish_modal").on("show.bs.modal",function(){ql.updatePublishModal(),setInterval(ql.updatePublishModal,5e3)}).modal()},ql.updatePublishModal=function(){console.log("updating publish modal");var t=$(".js-status").data("lab-id"),e=$(".js-status").data("url");$.get(e).done(function(e){"done"==e.status?window.location.href="/labs/"+t+"/snapshots/new":($("#snapshotJobModal .status").html("["+e.id+"] "+e.status),null!=e.message&&$("#snapshotJobModal .message").html(e.message))})},ql.quest={analytics:function(){function e(){var e={questName:gon.learning_path_name,label:gon.learning_path_name,category:"Quest",deployment:gon.deployment},t=document.querySelectorAll(".js-quest-enroll-button"),n=document.querySelectorAll(".js-quest-unenroll-button");document.querySelectorAll(".js-catalog-item-title a").forEach(function(e){return e.addEventListener("click",function(e){ql.track("clicked_quest_activity_link",{label:e.target.innerText,type:e.target.dataset.type})},!1)});var o=!0,i=!1,a=undefined;try{for(var r,s=t[Symbol.iterator]();!(o=(r=s.next()).done);o=!0){r.value.addEventListener("click",function(){ql.track("clicked_quest_enroll_button",e)})}}catch(f){i=!0,a=f}finally{try{!o&&s["return"]&&s["return"]()}finally{if(i)throw a}}var l=!0,c=!1,u=undefined;try{for(var d,m=n[Symbol.iterator]();!(l=(d=m.next()).done);l=!0){d.value;n.addEventListener("click",function(){ql.track("clicked_quest_unenroll_button",e)})}}catch(f){c=!0,u=f}finally{try{!l&&m["return"]&&m["return"]()}finally{if(c)throw u}}}return{init:e}}()};var initSearchAutocomplete=function initSearchAutocomplete(){jQuery.ui.autocomplete.prototype._resizeMenu=function(){this.menu.element.outerWidth(this.element.outerWidth())},0<$(".js-autocomplete").length&&$.getJSON("/searches/autocomplete.json",function(e){window.SEARCH_AUTOCOMPLETE_DISABLED||(e=e.map($.trim).sort(function(e,t){return e.localeCompare(t)}),$(".js-autocomplete").autocomplete({source:e,select:function n(e,t){$(this).val(t.item.value),$(this).parents("form").submit()}}))})},disableSearchAutocomplete=function disableSearchAutocomplete(){$(".js-autocomplete").autocomplete("instance")&&$(".js-autocomplete").autocomplete("disable")},initSearch=function initSearch(){initSearchAutocomplete(),$searchInput=document.getElementById("keywords"),$searchInput&&$searchInput.addEventListener("keydown",function(e){e.isComposing||13!=e.keyCode||ql.track("searched",{label:e.target.value})})};if($(function(){function e(){ql.experiments.getActiveExperiments().map(function(e){return e.optimize_id+"."+e.variant_index}).join("!")}if(gon.segment!=undefined){!function(){var n=window.analytics=window.analytics||[];if(!n.initialize)if(n.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{n.invoked=!0,n.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","page","once","off","on"],n.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);return e.unshift(t),n.push(e),n}};for(var e=0;e<n.methods.length;e++){var t=n.methods[e];n[t]=n.factory(t)}n.load=function(e){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+e+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n)},n.SNIPPET_VERSION="3.1.0",n.load(gon.segment)}}();var t="none";if(gon.deployment!=undefined&&(t=gon.deployment),gon.hasOwnProperty("current_user")){var n=gon.current_user;analytics.identify(t+"-"+n.id,{email:n.email,first_name:n.firstname,last_name:n.lastname,company:n.company,origin:n.origin,name:n.fullname,subscriptions:n.subscriptions,qlCreatedAt:n.qlCreatedAt,optIn:n.optIn,deployment:t})}analytics.ready(function(){e(),analytics.page()})}}),"undefined"==typeof jQuery)throw new Error("select_all requires jQuery");!function(c){c.fn.select_all=function(e){function n(e){for(var t=[],n=[];!e.is("body");)0<(n=e.find(":checkbox.selectable")).length?(t=n,e=c("body")):e=e.parent();return t}function o(e,t,n){switch(e.data("show_count")){case"checked":count_result="(Selected "+t+")";break;case"checked_with_total":count_result="("+t+"/"+n+")";break;case"unchecked":count_result="(Unselected "+(n-t)+")";break;default:count_result="(Selected "+t+")"}var o=c(e.data("attach_count_to"));0==o.length&&(o=e.parent()),0<c("span#select_all_count_id[data-select_all_uid='"+e.data("select_all_uid")+"']").length?c("span#select_all_count_id[data-select_all_uid='"+e.data("select_all_uid")+"']").text(count_result):c("<span id='select_all_count_id' data-select_all_uid="+e.data("select_all_uid")+">"+count_result+"</span>").appendTo(o)}function i(e){c(e).change(function(){var e=c(".select_all[data-select_all_class='"+a["class"]+"']"),t=c(".selectable."+a["class"]+":checked").length,n=c(".selectable."+a["class"]).length;t==n?e.prop("checked","checked"):e.prop("checked",!1),0<e.data("show_count").length&&o(e,t,n)})}var t,a=c.extend({"class":"no_class",infinite_scroll_select:!1,show_count:!1,attach_count_to:!1,uniq_id:Math.random()},e);if(0==c(this).length)return null;var r,s=c(this),l=s;return s.addClass("select_all").attr("data-select_all_class",a["class"]).attr("data-select_all_uid",a.uniq_id),s.data("show_count",a.show_count),s.data("attach_count_to",a.attach_count_to),0<(t=n(l)).length&&t.addClass(a["class"]),c(".select_all[data-select_all_class='"+a["class"]+"']").change(function(){c(".selectable."+a["class"]).prop("checked",c(this).prop("checked"))}),a.infinite_scroll_select&&(c(s).attr("data-total_child_count",t.length),c(document).ajaxComplete(function(){c("[data-total_child_count]").each(function(){var e=c(this),t=n(e);t.length>e.data("total_child_count")&&(t.addClass(e.data("select_all_class")),e.attr("data-total_child_count",t.length),i(t),e.prop("checked")&&t.prop("checked",!0),e.data("show_count")&&o(e,t.parent().find(":checked").length,t.length))})})),!1!==a.show_count&&o(s,t.parent().find(":checked").length,t.length),(r=s).change(function(){var e=c(".selectable."+a["class"]),t=c(this).prop("checked");if(e.prop("checked",t),0<r.data("show_count").length){var n=t?e.length:0;o(r,n,e.length)}}),i(t),c(this)}}(jQuery),initFirstTabActive=function(){$(".js-tab").first().addClass("is-active"),$(".js-tab-content").first().addClass("is-active")},initTabListener=function(){$(".js-tab").click(function(){var e=$(this).data("tab");$(".js-tab"
).removeClass("is-active"),$(this).addClass("is-active"),$(".js-tab-content").removeClass("is-active"),$(".js-tab-content[data-tab='"+e+"']").addClass("is-active")})},initTabs=function(){initTabListener()},ql.toggleButtons=function(){function e(){document.querySelectorAll(".toggle-button").forEach(function(e){e.hasAttribute("for")?(e.addEventListener("click",n,!1),e.addEventListener("keyup",t,!1)):e.disabled=!0})}function t(e){e.keyCode===c&&n.bind(this)()}function n(){this.classList.contains(s)?i(this):o(this)}function o(e){r(e,"on"),e.classList.add(s);var t=a(e);t&&t.classList.add(s)}function i(e){r(e,"off"),e.classList.remove(s);var t=a(e);t&&t.classList.remove(s)}function a(e){return document.getElementById(e.getAttribute("for"))}function r(e,t){e.hasAttribute(l)&&(document.cookie="toggleButton."+e.getAttribute(l)+"= "+t)}var s="is-toggled",l="local-storage-id",c=13;return{init:e}}(),initTooltips=function(){$('[data-toggle="tooltip"]').tooltip()};var trans={},initLabTranslations=function initLabTranslations(e){trans=e},initPaymentTranslations=function initPaymentTranslations(e){trans=e};ql.affiliateAutocomplete=function(){function e(){$(".js-affiliate-user-autocomplete").userAutocomplete({source:function o(e,t){var n="?q["+this.element[0].dataset.query+"]="+e.term;ql.getJson(this.element[0].dataset.autocomplete+n).then(function(e){t(e.map(function(e){return{label:e,value:e.email}}))})},open:function e(){$(".js-add-new-user").click(t)}})}function t(){var e=$(".js-affiliate-user-autocomplete").val();$('.js-new-user input[type="email"]').val(e),$(".js-new-user").removeClass("is-hidden"),$(".js-existing-user").addClass("is-hidden")}return{init:e}}(),retrieve_selected_emails=function(e){var n="";$(".selectable:checked").each(function(e,t){n=n.concat("<input name='selected_emails[]' value="+t.value+" hidden='True'></input>")}),e&&($(n).insertBefore($(e)[0]),$(e)[0].remove())};